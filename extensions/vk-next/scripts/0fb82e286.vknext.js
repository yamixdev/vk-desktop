"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[6746],{16746:(e,n,t)=>{t.a(e,async(e,a)=>{try{t.r(n);var i=t(57580),l=t(32795),u=t(65748),o=t(43024),c=e([i]);i=(c.then?(await c)():c)[0];let r=[],s=null;const d=()=>s||(s=new AudioContext({sampleRate:44100}),s),_=(e,n,t,a)=>{const i=e.createBiquadFilter();return i.type="peaking",i.frequency.value=t,i.Q.value=1,i.gain.value=n[a],i},p=()=>{const e=d(),n=o.default.getValue("curEqualizer"),t=l.A.map((t,a)=>_(e,n,t,a));return t.reduce(function(e,n){return e.connect(n),n}),t},v=e=>{if(e.__vknextEqualized)return;e.__vknextEqualized=!0,r.length||(r=p());const n=d();e.__source||(e.__source=n.createMediaElementSource(e)),e.__source.connect(r[0]),r.at(-1)?.connect(n.destination)};function E(){v(this)}function w(){this.__source?.disconnect()}let g=null;const f=e=>{null!==g&&g===e||(g&&(g.removeEventListener("playing",E),g.removeEventListener("stop",w)),window.ap&&window.ap.isPlaying()&&v(e),g=e,e.addEventListener("playing",E),e.addEventListener("stop",w))};let m=null;const h=async()=>{document.addEventListener("click",()=>d(),{once:!0}),m&&(m(),m=null),await(0,u.B)();let e=window.ap._impl._currentAudioEl.audioElement;f(e),m=window.ap.on(null,"curr",()=>{f(window.ap._impl._currentAudioEl.audioElement)})},y=async()=>{m&&(m(),m=null);const e=window.ap?._impl?._currentAudioEl?.audioElement;if(e){if(delete e.__vknextEqualized,e.__source){e.__source.disconnect();const n=d();e.__source.connect(n.destination)}e.removeEventListener("playing",E),e.removeEventListener("stop",w),g=null}};0,o.default.onInited(()=>{o.default.getValue("equalization")&&h()}),o.default.addChangeKeyListener("equalization",(e,n)=>{n?h():y()}),o.default.addChangeKeyListener("curEqualizer",(e,n)=>{if(r.length&&n)for(const[e,t]of Object.entries(n))r[+e].gain.value!==t&&(r[+e].gain.value=t)}),a()}catch(k){a(k)}})},32795:(e,n,t)=>{t.d(n,{A:()=>a});const a=[31,62,125,250,500,1e3,2e3,4e3,8e3,16e3]},65748:(e,n,t)=>{t.d(n,{B:()=>i});var a=t(50313);const i=()=>(0,a.A)("ap")}}]);