"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[122,4530],{4449:(t,e,n)=>{n.a(t,async(t,a)=>{try{n.d(e,{A:()=>k});var s=n(74848),r=n(11157),i=n(39107),o=n(96540),c=n(74225),l=n.n(c),u=n(52370),d=n(8015),p=n(68741),h=n(98570),A=n(90275),w=n(97992),g=n(11888),f=n(32477),m=t([d,g]);[d,g]=m.then?(await m)():m;const y="cachedAppsObject",v=async()=>{const{storage:t}=(0,h.A)().browserApi;return(await t.local.get(y))[y]||{}},_=async t=>{const{storage:e}=(0,h.A)().browserApi;return await e.local.set({[y]:t})},b=async t=>{if(0===t.length)return[];const e=await v(),n=[],a=new Map,s=[];for(const r in t){const i=t[r];n.push(e[i]),e[i]||(a.set(i,Number(r)),s.push(i))}if(0!==s.length){const t=(0,w.A)(s,20),r=await Promise.all(t.map(t=>u.vkapiWrapper.apps.get({app_ids:t,v:"5.130"})));for(const t of r)for(const s of t.items){if(!s.id)continue;const t=a.get(s.id);(t||0===t)&&("number"==typeof t?n[t]=s:n.push(s),e[s.id]=s)}}const r=n.filter(t=>!!t&&-1!==t.app_status);return await _(e),r},k=({app_ids:t,forceLoading:e})=>{const n=(0,d.A)(),[a,c]=(0,o.useState)([]),[u,h]=(0,o.useState)(!0),w=(0,r.Gz)(),{appId:m}=(0,r.g)()??{};l()(async e=>{h(!0);const n=await b(t);e()&&(c(n),h(!1))},[t]);const y=u||e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.ZAh,{sizeX:i.qAW.COMPACT,sizeY:i.qAW.COMPACT,children:(0,s.jsx)(g.A,{})}),(0,s.jsx)(i.Y9Y,{size:"s",multiline:!0,children:n.use("settings_emoji_status_popular")}),y&&(0,s.jsx)(s.Fragment,{children:new Array(50).fill(1).map((t,e)=>(0,s.jsx)(A.vH,{leftIcon:(0,s.jsx)(i.euF,{size:24}),disabled:!0,className:f.A.MiniApps_cell,children:(0,s.jsx)(i.EAD,{width:200})},`miniAppSkeleton-${e}`))}),!y&&0===a.length&&(0,s.jsx)(i.OrA,{children:n.use("global_not_found")}),!y&&a.map(t=>(0,s.jsx)(A.vH,{leftIcon:(0,s.jsx)(i.euF,{size:24,src:t.icon_278||t.icon_139||t.icon_150||t.icon_75||t.icon_16}),onClick:()=>{t.id&&w.replace(p.JZ.root.emojiStatus.view,{appId:t.id.toString()})},isActive:Boolean(m&&t?.id&&m===t.id.toString()),className:f.A.MiniApps_cell,children:t.title},t.id))]})};a()}catch(t){a(t)}})},11888:(t,e,n)=>{n.a(t,async(t,a)=>{try{n.d(e,{A:()=>f});var s=n(74848),r=n(11157),i=n(39107),o=n(96540),c=n(74225),l=n.n(c),u=n(82295),d=n(8015),p=n(57087),h=n(68741),A=n(32477),w=t([d]);d=(w.then?(await w)():w)[0];const g=t=>{if(!t)return null;const e=t.match(/(?:https?:\/\/)?(?:www\.)?(?:vk\.com|vk\.ru)\/app(\d+)|app(\d+)|(\d+)/);return e?e[1]||e[2]||e[3]:null},f=()=>{const t=(0,o.useRef)(null),e=(0,r.Gz)(),{showSnackbar:n,hideSnackbar:a}=(0,p.Qs)(),c=(0,d.A)();l()(async e=>{const n=setTimeout(()=>{e&&t.current?.focus()},0);return()=>clearTimeout(n)},[t]);const w=()=>{if(!t.current?.value)return;const r=g(t.current.value);r?e.replace(h.JZ.root.emojiStatus.view,{appId:r.toString()}):n((0,s.jsx)(i.qb_,{onClose:a,children:c.use("settings_emoji_status_invalid_link")}))};return(0,s.jsx)(i.eIh,{top:c.use("settings_emoji_status_link_form_name_label"),className:A.A.FormItem,children:(0,s.jsxs)("div",{className:A.A.FormUserLink,children:[(0,s.jsx)("div",{className:A.A.FormUserLink__input,children:(0,s.jsx)(i.pde,{placeholder:`${u.A}/app7362610`,type:"text",getRef:t,onKeyUp:t=>{"Enter"===t.key&&w()}})}),(0,s.jsx)("div",{className:A.A.FormUserLink__button,children:(0,s.jsx)(i.$nd,{size:"l",onClick:w,children:c.use("global_open")})})]})})};a()}catch(t){a(t)}})},14694:(t,e,n)=>{n.d(e,{A:()=>a});const a=()=>"https://api.vknext.net"},20143:(t,e,n)=>{n.d(e,{_:()=>a});var a=(0,n(78414).mT)("Icon28ArrowLeftOutline","arrow_left_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="arrow_left_outline_28"><g fill="none" fill-rule="evenodd"><path d="M28 0H0v28h28z" /><path fill="currentColor" fill-rule="nonzero" d="M12.293 6.293a1 1 0 0 1 1.414 1.414L8.414 13H22a1 1 0 0 1 .993.883L23 14a1 1 0 0 1-1 1H8.414l5.293 5.293a1 1 0 0 1 .083 1.32l-.083.094a1 1 0 0 1-1.414 0l-7-7-.073-.082A1 1 0 0 1 5 14l.004.09L5 14.02V14a1 1 0 0 1 .125-.484 1 1 0 0 1 .071-.111 1 1 0 0 1 .097-.112l-.08.09q.037-.047.08-.09Z" /></g></symbol>',28,28,!1,void 0)},24370:(t,e,n)=>{n.d(e,{Q:()=>c});var a=n(92046),s=n(14694),r=n(88400),i=n(46140),o=n(47961);class c{vkapi;vkAgents;userId;constructor({api:t}){this.vkapi=t,this.userId=0,this.vkAgents=new Map}async call(t,e,n){const i=await this.getVkAgent(),o={...e,"vknext-agent":await this.gvkna()};let c=0;const l=`${(0,s.A)()}/${t}`,u=JSON.stringify(o),d={Accept:"application/json","Content-Type":"application/json","VK-Agent":i,"VK-User-ID":`${this.userId||0}`,"9603a224b40d7b67210b78f2e390d00f":"ba05681e16c97c31e1be20e84f250d55","Api-Version":"3",...n};let p=new Response(JSON.stringify({error_code:408}),{status:408});for(;c<3;){const t=new AbortController,e=setTimeout(()=>t.abort(),15e3);try{if(p=await fetch(l,{body:u,method:"POST",headers:d,signal:t.signal}),502!==p.status)return(0,r.A)(p);{await(0,a.c)(2e3);const t=await p.text();if(!t.toLowerCase().includes("cloudflare"))return(0,r.A)(p);await(0,a.c)(c)}}catch(t){console.error(t),await(0,a.c)(2e3)}clearTimeout(e),c++}return(0,r.A)(p)}async getVkAgent(){if(0===this.userId&&(this.userId=await this.getUserId()),this.vkAgents.has(this.userId))return this.vkAgents.get(this.userId);return(0,i.A)(this.userId,this.vkapi)}async gvkna(){return await(0,o.A)(this.userId,"ba05681e16c97c31e1be20e84f250d55",this)}resetUserId(){this.userId=0}async getUserId(){return 0}async getRuntimeId(){return""}async getVersion(){return""}}},32477:(t,e,n)=>{n.d(e,{A:()=>a});const a={FormUserLink:"t5QNpP97fq6LjbuP",FormUserLink__input:"TcQXzUQij6J_FDLg",FormUserLink__button:"P8BrjaNM82fMfg96",FormItem:"GKKvRoZi1cFR79om",MiniApps_cell:"azSnFgtc11wO1Z1r"}},44530:(t,e,n)=>{n.a(t,async(t,a)=>{try{n.r(e),n.d(e,{default:()=>_});var s=n(74848),r=n(39107),i=n(96540),o=n(74225),c=n.n(o),l=n(70122),u=n(86417),d=n(1883),p=n(58006),h=n(35381),A=n(78760),w=n(68741),g=n(57652),f=n(4449),m=t([g,f]);[g,f]=m.then?(await m)():m;const y=async()=>await l.default.call("status.getMiniApps"),v=()=>{const[t,e]=(0,i.useState)([]),[n,a]=(0,i.useState)(!0);return c()(async t=>{a(!0);const n=await y();t()&&(e(n),a(!1))},[]),(0,s.jsx)(f.A,{app_ids:t,forceLoading:n})},_=()=>{const t=(0,p.A)({isGroup:!0});return(0,s.jsxs)(A.A,{children:[(0,s.jsx)(u.A,{}),(0,s.jsx)(d.A,{style:{maxHeight:t-60-16},children:(0,s.jsx)(v,{})}),(0,s.jsx)(r.KzX,{size:16}),(0,s.jsx)(r.YJl,{children:(0,s.jsx)(h.A,{children:(0,s.jsx)(g.A,{to:w.JZ.root.main.home})})})]})};a()}catch(t){a(t)}})},46140:(t,e,n)=>{n.d(e,{A:()=>d});var a=n(22440),s=n(92046),r=n(98570),i=n(75412);const o=(0,a.A)(),c=async t=>{const e=(0,r.A)().browserApi;if(e){return(await e.storage.local.get(t))[t]}if(o?.localStorage)return o.localStorage.getItem(t);const{storage:a}=await n.e(6815).then(n.t.bind(n,96815,23));return(await a.local.get(t))[t]},l=async(t,e)=>{const a=(0,r.A)().browserApi;if(a)return void await a.storage.local.set({[t]:e});if(o?.localStorage)return void o.localStorage.setItem(t,e);const{storage:s}=await n.e(6815).then(n.t.bind(n,96815,23));await s.local.set({[t]:e})},u=async(t,e)=>{const n=`vknLP${t}`,a=`vknLPD${t}`,r=await c(n),o=await c(a);if(r&&Date.now()-(parseInt(o||"")||0)<216e5)return r?.response||r;try{const r=await e.apps.getAppLaunchParams({mini_app_id:await(0,i.A)(),referer:"other",v:"5.123"}),o=new URLSearchParams(Object.entries(r)).toString();return o?(await l(n,o),await l(a,Date.now().toString()),o):(await(0,s.c)(5e3),u(t,e))}catch(n){return console.error(n),await(0,s.c)(1500),u(t,e)}},d=u},47961:(t,e,n)=>{n.d(e,{A:()=>s});var a=n(387);const s=async(t,e,n)=>{try{delete Uint8Array.prototype.toJSON}catch(t){console.error(t)}const s=(0,a.A)(),r=((t,e)=>{const n=t.toString().length,a=new Uint8Array(16);for(let s=0;s<e.length;s++){const r=e.charCodeAt(s)*t/n;a[s%16]^=255&r}return a})(t,e),i=await(t=>crypto.subtle.importKey("raw",t,{name:"AES-CBC"},!1,["encrypt"]))(r),o={version:await n.getVersion(),udGltZS5p:await n.getRuntimeId(),cGlkb3I:t,fdhjiD:"ba05681e16c97c31e1be20e84f250d55",v9Cdi3sD:s},c=JSON.stringify(o),l=(new TextEncoder).encode(c),u={name:"AES-CBC",iv:crypto.getRandomValues(new Uint8Array(16))},d=await crypto.subtle.encrypt(u,i,l),p=new Uint8Array(u.iv.length+d.byteLength);return p.set(new Uint8Array(u.iv),0),p.set(new Uint8Array(d),u.iv.length),p}},57652:(t,e,n)=>{n.a(t,async(t,a)=>{try{n.d(e,{A:()=>p});var s=n(74848),r=n(8015),i=n(42338),o=n(5902),c=n(68741),l=n(20143),u=n(11157),d=t([r]);r=(d.then?(await d)():d)[0];const p=({to:t=c.JZ.root.main.home})=>{const e=(0,r.A)(),{iconSize:n}=(0,o.A)(),a=(0,u.XC)(),d=(0,u.Gz)();return(0,s.jsx)(i.A,{leftIcon:(0,s.jsx)(l._,{width:n,height:n}),onClick:async()=>{a?await d.push(t):await d.back()},children:e.use("settings_menu_left_back_title")})};a()}catch(t){a(t)}})},70122:(t,e,n)=>{n.r(e),n.d(e,{default:()=>c});var a=n(98570),s=n(24370),r=n(87251);const i=new s.Q({api:r.default});let o=!1;i.getUserId=async()=>"number"==typeof window.vk?.id?window.vk.id:o?await new Promise(t=>{const e=setInterval(()=>{o||(t(r.default.user_id),clearInterval(e))},200)}):(r.default.user_id||(o=!0,await r.default.forceUpdateToken(),o=!1),r.default.user_id),i.getRuntimeId=async()=>{const{getManifest:t}=(0,a.A)().browserApi;return t().id},i.getVersion=async()=>{const{getManifest:t}=(0,a.A)().browserApi;return t().version};const c=i},75412:(t,e,n)=>{n.d(e,{A:()=>s});var a=n(14694);const s=async()=>{try{const t=await fetch(`${(0,a.A)()}/internal.getAuthAppId`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","Api-Version":"3"}});if(t.ok)return parseInt(await t.text())}catch(t){console.error("[VK Next/getAuthAppId] Error:",t)}return 8194076}},88400:(t,e,n)=>{n.d(e,{A:()=>a});const a=async t=>{const e=await t.json(),a=t.headers.get("Content-Type");if(a&&a.startsWith("application/x-vknextpack")&&e)try{const t=new Uint8Array(Object.values(e)),{decode:a}=await n.e(7802).then(n.bind(n,77802));return a(t)}catch(t){console.error(t)}return e}},97992:(t,e,n)=>{n.d(e,{A:()=>a});const a=(t,e=100)=>{const n=[...t],a=[];for(;n.length;)a.push(n.splice(0,e||n.length));return a}}}]);