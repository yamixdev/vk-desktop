"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[3238],{10393:(e,t,n)=>{n.d(t,{A:()=>s});const o="uBcgcyAcjnZjML_w",s=()=>{const e=document.createElement("div");return e.className=o,e}},17100:(e,t,n)=>{n.d(t,{Ay:()=>i,Fs:()=>l,Hb:()=>c});var o=n(74848),s=n(96540);const r=(0,s.createContext)(null),a=()=>{const e=(0,s.useContext)(r);if(!e)throw new Error("CustomModalPageContext has not been passed in provider");return e},c=()=>{const e=a();return{closeModal:()=>e.setOpen(!1)}},l=()=>{const{onClose:e,onClosed:t,onOpen:n,onOpened:o,open:s,setOpen:r}=a();return{open:s,setOpen:r,onClose:e,onClosed:t,onOpen:n,onOpened:o}},i=({onClose:e,onClosed:t,onOpen:n,onOpened:a,...c})=>{const[l,i]=(0,s.useState)(!0);return(0,o.jsx)(r.Provider,{value:{open:l,setOpen:i,onClose:e,onClosed:t,onOpen:n,onOpened:a},...c})}},24560:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(89307);const s=async()=>{const{default:e}=await Promise.all([n.e(961),n.e(7397),n.e(1649),n.e(8414),n.e(8726)]).then(n.bind(n,88726));return(0,o.A)(e,{zIndex:501})}},32527:(e,t,n)=>{n.a(e,async(e,o)=>{try{n.r(t);var s=n(57580),r=n(38729),a=n(13536),c=n(93819),l=n(2006),i=n(88833),d=n(43024),u=n(24560),m=n(91797),p=n(68331),f=n(66604),y=n(10393),_=e([s]);s=(_.then?(await _)():_)[0];const A=(0,r.NS)(),b=(0,r.sr)(),h=async e=>{const t=e.querySelector(".ms_items_more_helper > .ms_items_more");if(!t)return;if(t.dataset[b])return;const o=d.default.getValue("enableBtnGraffiti"),s=d.default.getValue("enableBtnAudio")&&!t.closest(".reply_form"),r=d.default.getValue("enableBtnVideoMessage")&&!t.closest(".reply_form");if(!o&&!s&&!r)return;t.dataset[b]="1";const a=await c.A;if(t.append((0,y.A)()),o){const{default:e}=await n.e(7539).then(n.bind(n,97539));t.append((0,f.A)({title:a.use("vkcom_graffiti"),icon:e,onClick:m.A}))}if(s){const{default:e}=await n.e(4980).then(n.bind(n,74980));t.append((0,f.A)({title:a.use("vkcom_audio_message"),icon:e,onClick:u.A}))}if(r){const{default:e}=await n.e(9009).then(n.bind(n,89009));t.append((0,f.A)({title:a.use("vkcom_video_message"),icon:e,onClick:p.A}))}},v=()=>{(0,a.h)(e=>{if(e._mib_hooked)return;e._mib_hooked=!0;const t=e.initReplyEditable;e.initReplyEditable=function(...e){const n=e[1];return n[A]||(n[A]=new MutationObserver(e=>{for(const{addedNodes:t}of e)for(const e of t){if(e.classList.contains("ms_item"))return n._mbs&&(n._mbs.disconnect(),delete n._mbs),void h(n)}}),n[A].observe(n,{childList:!0,subtree:!0}),l.A.add(n)),Reflect.apply(t,this,e)}});for(const e of document.querySelectorAll(".media_selector .reply_box_more_attaches"))h(e);const e=()=>{for(const e of document.querySelectorAll("._im_media_selector .ms_items_more_wrap"))h(e)};e(),(0,i.A)(()=>{e()})};0,d.default.onInited(v),o()}catch(e){o(e)}})},53644:(e,t,n)=>{n.d(t,{A:()=>s});let o=0;const s=e=>{const t=!!document.importNode;let n=(new DOMParser).parseFromString(e,"image/svg+xml").documentElement;t&&(n=document.importNode(n,!0));for(const e of n.querySelectorAll("title,desc"))e.remove();for(const e of n.querySelectorAll("[id]")){if(!e.id)continue;const t="vknext_icon-"+o++;let s=!1;for(const o of n.querySelectorAll(`[fill="url(#${e.id})"]`))o.setAttribute("fill",`url(#${t})`),s=!0;s&&(e.id=t)}return n}},66604:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(53644);const s=({icon:e,title:t,onClick:n})=>{const s=document.createElement("a");s.className="ms_item",s.addEventListener("click",n);const r=document.createElement("span");r.className="MediaSelector__mediaIcon",r.append((0,o.A)(e));const a=document.createTextNode(t);return s.append(r),s.append(a),s}},68331:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(89307);const s=async()=>{const{default:e}=await Promise.all([n.e(961),n.e(7397),n.e(1649),n.e(8414),n.e(5539)]).then(n.bind(n,65539));return(0,o.A)(e,{zIndex:501})}},88833:(e,t,n)=>{n.d(t,{A:()=>m});var o=n(22440),s=n(22707),r=n(48913),a=n(91570),c=n(51018);const l=(0,o.A)(),i=new c.e,d=async e=>{for(const t of i.listeners)try{await(0,s.t)(),t?.(e)}catch(e){console.error(e)}};let u=!1;const m=e=>{const t=i.addListener(e);return(async()=>{if(!l.location.pathname.startsWith("/gim"))return;const e=(await(0,r.e)()).peer;e&&await d(e)})().catch(console.error),u||(u=!0,(async()=>{(await(0,a.R)()).onLocationChange(async e=>{if(!e.startsWith("gim"))return;const t=l.cur.peer;t&&await d(t)})})().catch(console.error)),t}},89307:(e,t,n)=>{n.d(t,{A:()=>u});var o=n(74848),s=n(17100),r=n(3068);const a="d32BOj2kmVxWOEmy";let c=null,l=!1;const i=()=>{l||(l=!0,c=window.getComputedStyle(document.body).overflow,document.body.style.overflow="hidden")},d="--vknext--z_index_modal",u=async(e,{zIndex:t}={})=>{const n=document.createElement("div"),u=document.createElement("div");t&&(n.className=a,u.className=a,u.style.setProperty(d,t.toString()),n.style.setProperty(d,t.toString())),document.body.appendChild(n),document.body.appendChild(u);const{unmount:m}=await(0,r.A)({root:n,portal:u,content:(0,o.jsx)(s.Ay,{onOpen:i,onClosed:()=>{setTimeout(()=>{l&&(l=!1,null!==c&&(document.body.style.overflow=c,c=null))},100),setTimeout(()=>{m(),n.remove(),u.remove()},1e3)},children:"function"==typeof e?(0,o.jsx)(e,{}):e}),disableParentTransformForPositionFixedElements:!0,disableAnchorTextDecoration:!0})}},91797:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(89307);const s=async()=>{const{default:e}=await Promise.all([n.e(961),n.e(7397),n.e(1649),n.e(8414),n.e(5109)]).then(n.bind(n,5109));return(0,o.A)(e,{zIndex:501})}}}]);