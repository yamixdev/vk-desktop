"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[9964],{5679:(o,e,r)=>{r.d(e,{A:()=>i});var t=r(51018),n=r(65879);const _=new t.e,c=new t.e,a=async()=>{(o=>{if(o._meAppHooked)return;o._meAppHooked=!0;const e=o.store.dispatch;let r=o.store.getState()?.ownerId;o.store.dispatch=function(...t){const[n]=t;r||(r=o.store.getState()?.ownerId);let a=!1;for(const o of c.listeners)try{const e=o(n);"boolean"==typeof e&&e&&(a=!0)}catch(o){console.error(o)}if(a)return;const i=Reflect.apply(e,o.store,t);for(const o of _.listeners)try{o(n)}catch(o){console.error(o)}return i}})(await(0,n.A)())},i=(o,e=!1)=>{const r=(e?_:c).addListener(o);return a(),r}},47648:(o,e,r)=>{r.d(e,{A:()=>k});var t=r(49032),n=r(7417),_=r(51018),c=r(22707),a=r(91570);const i=(0,r(38729).sr)(),l=new _.e,u=()=>{if(document.querySelector(".im-page:not(.im-page_group)"))return void setTimeout(u,1e3);const o=document.querySelector("#reforged-root,.VKCOMMessenger__reforgedRoot");o?o.querySelector(".VKCOMMessenger__skeletonWrapper")?setTimeout(u,500):(o=>{if(!o[i]){o[i]=!0;for(const e of l.listeners)e(o)}})(o):0===document.getElementById("wrap3")?.children.length&&setTimeout(u,500)},d=async o=>{if(document.getElementsByClassName("im-page")[0]&&!o)return void(0,n.n)(()=>d(!0));const e=await(0,a.R)();u(),e.onLocationChange(async o=>{await(0,c.t)(),t.lz.test(o)&&u()})};let s=!1;const k=o=>{const e=l.addListener(o);return(0,n.n)(u),s||(s=!0,d()),e}},49032:(o,e,r)=>{r.d(e,{Fl:()=>c,XZ:()=>_,hj:()=>n,lz:()=>t,pz:()=>i});const t=/(^|\/)al_im\.php|(^|\/)im(\?|$)|(^|\/)gim\d+|\/write-?\d+/,n=/(^|\/)al_im\.php|(^|\/)im(\?|$)|\/write-?\d+|\/im\/.*/,_={"--accent":"--vkui--color_icon_accent","--background_content":"--vkui--color_background_content","--background_highlighted":"--vkui--color_transparent--active","--background_hover":"--vkui--color_transparent--hover","--background_light":"--vkui--color_background_tertiary","--background_page":"--vkui--color_background","--background_suggestions":"--vkui--color_background_modal","--button_commerce_background":"--vkui--color_text_positive","--button_secondary_background":"--vkui--color_background_secondary_alpha","--button_secondary_destructive_foreground":"--vkui--color_background_negative","--content_tint_background":"--vkui--color_background_secondary","--content_warning_background":"--vkui--color_background_warning","--counter_prominent_text":"--vkui--color_text_contrast","--destructive":"--vkui--color_text_negative","--dynamic_gray":"--vkui--color_accent_gray","--dynamic_green":"--vkui--color_accent_green","--dynamic_orange":"--vkui--color_accent_orange","--dynamic_purple":"--vkui--color_accent_purple","--dynamic_red":"--vkui--color_accent_red","--dynamic_violet":"--vkui--color_accent_violet","--dynamic_blue":"--vkui--color_accent_blue","--dynamic_raspberry_pink":"--vkui--color_accent_raspberry_pink","--field_background":"--vkui--color_field_background","--field_border":"--vkui--color_field_border_alpha","--field_error_background":"--vkui--color_background_negative_tint","--field_error_border":"--vkui--color_stroke_negative","--field_valid_border":"--vkui--color_stroke_positive","--header_background":"--vkui--color_header_background","--header_tint_alternate":"--vkui--color_icon_accent_themed","--icon_alpha_placeholder":"--vkui--color_icon_contrast","--icon_medium_alpha":"--vkui--color_icon_medium_alpha","--icon_medium":"--vkui--color_icon_medium","--icon_secondary_alpha":"--vkui--color_icon_secondary_alpha","--icon_secondary":"--vkui--color_icon_secondary","--icon_tertiary_alpha":"--vkui--color_icon_tertiary_alpha","--icon_tertiary":"--vkui--color_icon_tertiary","--image_border":"--vkui--color_image_border_alpha","--input_background":"--vkui--color_write_bar_input_background","--input_border":"--vkui--color_write_bar_input_border_alpha","--link_alternate":"--vkui--color_text_link_themed","--loader_track_fill":"--vkui--color_track_background","--loader_track_value_fill":"--vkui--color_track_buffer","--placeholder_icon_background_opaque":"--vkui--color_image_placeholder_alpha","--placeholder_icon_background":"--vkui--color_image_placeholder","--search_bar_field_background":"--vkui--color_search_field_background","--segmented_control_bar_background":"--vkui--color_segmented_control","--separator_alpha":"--vkui--color_separator_primary_alpha","--separator_alternate":"--vkui--color_separator_secondary","--separator_common":"--vkui--color_separator_primary","--skeleton_foreground_from":"--vkui--color_skeleton_from","--skeleton_foreground_to":"--vkui--color_skeleton_to","--text_link":"--vkui--color_text_link","--text_muted":"--vkui--color_text_muted","--text_primary":"--vkui--color_text_primary","--text_secondary":"--vkui--color_text_secondary","--text_subhead":"--vkui--color_text_subhead","--text_tertiary":"--vkui--color_text_tertiary","--writebar_icon":"--vkui--color_write_bar_icon","--gray_400":"--vkui--color_text_secondary","--gray_500":"--vkui--color_text_subhead","--gray_600":"--vkui--color_text_subhead","--gray_900":"--vkui--color_text_muted","--im_forward_line_tint":"--vkui--vkontakte_color_im_forward_line_alpha","--im_bubble_incoming":"--vkui--vkontakte_color_im_bubble_incoming","--im_bubble_incoming_alternate":"--vkui--vkontakte_color_im_bubble_incoming_alternate","--im_bubble_incoming_expiring":"--vkui--vkontakte_color_im_bubble_incoming_expiring","--im_bubble_border_alternate_highlighted":"--vkui--vkontakte_color_im_bubble_border_alternate_highlighted_alpha","--modal_card_background":"--vkui--color_background_modal","--im_bubble_outgoing":"--vkui--vkontakte_color_im_bubble_outgoing"},c=1e3,a=globalThis.navigator.hardwareConcurrency||1,i=Math.max(1,Math.floor(a/2))},56969:(o,e,r)=>{r.d(e,{A:()=>d});var t=r(51018),n=r(38729),_=r(47648);const c=new t.e,a=(0,n.NS)(),i=o=>{for(const e of c.listeners)e(o)},l=o=>{const e=o.querySelector(".MEApp__content,.MEApp__mainPanel");e?i(e):o[a]&&(o[a]=new MutationObserver(()=>{const e=o.querySelector(".MEApp__content,.MEApp__mainPanel");e&&(i(e),o[a].disconnect())}),o[a].observe(o,{childList:!0,subtree:!0}))};let u=!1;const d=o=>{const e=c.addListener(o);return u||(u=!0,(0,_.A)(l)),e}},89964:(o,e,r)=>{r.d(e,{A:()=>v});var t=r(22707),n=r(51018),_=r(38729),c=r(56969),a=r(94169);const i=(0,_.NS)(),l=".ConvoMain__composerContent,.ConvoComposer",u=new n.e,d=o=>{for(const e of u.listeners)e(o)},s=async()=>{await(0,t.t)();const o=document.querySelector(".ConvoMain__composer");if(!o)return;if(o[i])return;for(const e of o.querySelectorAll(l))d(e);o[i]=new MutationObserver(async()=>{for(const e of o.querySelectorAll(l))await d(e)}),o[i].observe(o,{childList:!0});const e=nav.onLocationChange(()=>{document.body.contains(o)||(o[i]&&(o[i].disconnect(),delete o[i]),e())})};let k=!1;const v=o=>{const e=u.addListener(o);return(0,c.A)(async()=>{var o;o=window.location.pathname,/^\/?(im|gim\d+)\/convo\//.test(o)&&await s()}),k||(k=!0,(0,a.A)(s)),e}},94169:(o,e,r)=>{r.d(e,{A:()=>l});var t=r(51018),n=r(5679);const _=new t.e,c=async o=>!!document.querySelector(".ConvoMain")&&(await(async o=>{for(const e of _.listeners)try{e?.(o)}catch(o){console.error(o)}})(o),!0);let a,i;(0,n.A)(async o=>{if("UserOpenedConvo"===o.type&&(a=o.peerId,!await c(o.peerId))){i&&clearTimeout(i);const e=setTimeout(async()=>{o.peerId===a?await c(o.peerId)&&clearTimeout(e):clearTimeout(e)},800);i=e}},!0);const l=o=>_.addListener(o)}}]);