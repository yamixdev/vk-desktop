"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[2682,4144],{21867:(e,t,n)=>{n.a(e,async(e,a)=>{try{n.r(t);var s=n(74848),r=n(57580),o=n(22707),c=n(37400),i=n(39107),l=n(38729),u=n(13536),d=n(89964),m=n(67767),p=n(43171),y=n(3068),h=n(88833),w=n(84144),f=n(53814),g=e([r]);r=(g.then?(await g)():g)[0];const k=(0,l.sr)(),E=new Set;let _=!1;const b=()=>{_||(_=!0,(0,p.A)(()=>{for(const e of E)e();E.clear(),_=!1}))},A=async()=>(await w.default.getPacks()).length>0,v=async(e,t=!1)=>{await(0,c.G)(),await(0,o.t)();const a=await Promise.all([n.e(2295),n.e(6474)]).then(n.bind(n,76474)),{unmount:r}=await(0,y.A)({root:e,content:(0,s.jsx)(a.default,{isReply:t}),disableParentTransformForPositionFixedElements:!0});return E.add(r),b(),r},C=async(e,t=!1)=>{const n=e.querySelector(".reply_field_wrap,.reply_fakebox_container");if(!n)return;if(n.getElementsByClassName(k).length)return;const a=e.dataset.postId,s=document.createElement("div");s.className=(0,i.xWm)(k,f.A.replyFakeButton),n.appendChild(s);const r=v(s,!0);t||s.addEventListener("mouseover",()=>{Wall.showEditReply(a,null,!1,!1,!1,async()=>{await(0,o.t)(),await C(e,!0),n.contains(s)||(await r)()})}),await r};0,(async()=>{await A()&&((0,d.A)(async e=>{const t=e.querySelector(".Composer__inputPanel,.ConvoComposer__inputPanel");if(!t)return;if(t.querySelector(`.${k}`))return;const n=t.querySelector(".StickerEmojiMenuPopper"),a=document.createElement("div");a.className=k,n?n.insertAdjacentElement("beforebegin",a):t.appendChild(a),await v(a)}),(0,h.A)(async()=>{const e=document.getElementsByClassName("im_chat-input--buttons")[0];if(!e)return;if(e.getElementsByClassName(k).length)return;const t=document.createElement("div");t.className=k;const n=e.querySelector(".im-chat-input--smile-wrap,.emoji_smile_wrap");n&&n.insertAdjacentElement("beforebegin",t),await v(t)}),(0,m.A)(C),(0,u.h)(e=>{if(e._tgs_hooked)return;e._tgs_hooked=!0;const t=e.initReplyEditable;e.initReplyEditable=function(...n){const a=Reflect.apply(t,e,n);return requestAnimationFrame(()=>{const[e,t,a]=n,s=e?.closest(".post")??t?.closest(".post")??(a?document.getElementById(`post${a}`):null);s&&C(s)}),a}}))})().catch(console.error),a()}catch(e){a(e)}})},53814:(e,t,n)=>{n.d(t,{A:()=>a});const a={replyFakeButton:"rcz0YdKMeR0RRy4S"}},84144:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});var a=n(53778);class s extends a.default{constructor(){super("telegramStickers",{lifetime:1e4,defaultValue:[]})}async getPacks(){return[...await this.getStorage()]}}const r=new s},88833:(e,t,n)=>{n.d(t,{A:()=>m});var a=n(22440),s=n(22707),r=n(48913),o=n(91570),c=n(51018);const i=(0,a.A)(),l=new c.e,u=async e=>{for(const t of l.listeners)try{await(0,s.t)(),t?.(e)}catch(e){console.error(e)}};let d=!1;const m=e=>{const t=l.addListener(e);return(async()=>{if(!i.location.pathname.startsWith("/gim"))return;const e=(await(0,r.e)()).peer;e&&await u(e)})().catch(console.error),d||(d=!0,(async()=>{(await(0,o.R)()).onLocationChange(async e=>{if(!e.startsWith("gim"))return;const t=i.cur.peer;t&&await u(t)})})().catch(console.error)),t}}}]);