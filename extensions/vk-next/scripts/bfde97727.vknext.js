"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[9988],{422:(e,s,t)=>{t.d(s,{A:()=>c});var a=t(74848),i=t(39107);const n="kEOK11qd0k9Jv15F",r="E5_YQoaWDka1Aaai",c=({isOut:e,children:s})=>{const t=(0,i.xWm)(n,e&&r);return(0,a.jsx)("div",{className:t,children:s})}},20932:(e,s,t)=>{t.d(s,{A:()=>a});const a={MessagesViewerGroup__history:"VbFsusSOCNRJ8IXi",MessagesViewerGroup:"Elo3MRoJoViOxMi1"}},30598:(e,s,t)=>{t.d(s,{A:()=>l});var a=t(24382),i=t(76299);let n=/\[(id|club)(\d+)(?:\:([a-z0-9_\-]+))?\|([^\$]+?)\]/g,r=/([a-zA-Zа-яА-Я\-_\.0-9\+]+@(((?:[\w\$А-Яа-яёЁєЄҐґЇїІіЈј—\-\_]+\.){1,5})([A-Za-zа-яА-Я\-\d]{2,22})))/gi;const c=/^(https?:\/\/)?([\w-]{1,32}\.[\w-]{1,32})[^\s@]*$/,o=/(?!,|;|:|\.|\s|<br ?\/?>|"|\(|\)|\[|\]|!|\?)(@all|\*all|@everyone|\*everyone|@все|\*все|@online|\*online|@here|\*here|@здесь|\*здесь|@тут|\*тут)(?=$|,|;|:|\.(?![a-z0-9_-])|\s|<br ?\/?>|"|\(|\)|\[|\]|!|\?)/gi,l=(e,{escape:s,mentions:t,mail:l,link:m,allMentions:_,emoji:d})=>(s&&(e=(0,i.A)(e)),t&&(e=e.replaceAll(n,(e,s,t,a,i)=>`<a href="/${s}${t}" class="mem_link" mention="" mention_id="${s}${t}" onclick="return mentionClick(this, event)" onmouseover="mentionOver(this)">${i}</a>`)),l&&(e=e.replaceAll(r,e=>`<a href="mailto:${e}">${e}</a>`)),m&&(e=e.split("<br>").map(e=>e.split(" ").map(e=>{if(!c.test(e)&&!(0,a.A)(e))return e;const s="/away.php?"+new URLSearchParams({utf:"1",to:`${e.startsWith("http://")||e.startsWith("https://")?"":"http://"}${e}`,cc_key:""});return`<a href="${(0,i.A)(s)}" target="_blank" rel="nofollow noopener">${e}</a>`}).join(" ")).join("<br>")),_&&(e=e.replaceAll(o,e=>`<span class="mem_pseudolink" data-mention="${e.slice(1).toLowerCase()}">${e}</span>`)),d&&window.Emoji?.emojiRegex&&(e=e.replaceAll(window.Emoji.emojiRegex,window.Emoji.emojiReplace)),e)},40473:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.d(s,{A:()=>N});var i=t(74848),n=t(59813),r=t(422),c=t(88496),o=t(89749),l=t(83506),m=t(59154),_=t(51466),d=t(94249),h=t(7618),u=t(39107),p=t(96540),x=t(67685),g=t(87675),k=t(20932),j=e([o,x,g]);[o,x,g]=j.then?(await j)():j;const v="historyItem_",y="message_",f=e=>{const s={};for(const[t,a]of Object.entries(e)){const e=Number(t);e&&(s[e]||(h.z.isUserId(e)&&(a.deactivated&&!a.first_name?s[a.id]={ins:"DELETED",acc:"DELETED",picUrl:a.photo_50}:s[a.id]={ins:`${a.first_name} ${a.last_name}`,acc:`${a.first_name_acc} ${a.last_name_acc}`,picUrl:a.photo_50}),h.z.isGroupId(e)&&(s[e]={name:a.name,picUrl:a.photo_50})))}return s},N=({messages:e,users:s,isEdit:t})=>{const a=(0,p.useMemo)(()=>f(s),[s]);(0,_._)(a);const h=(0,g.A)(),j=[];let N=[],A=[],w=e[0].from_id,b=!!e[0].out,$=null,C=0;const T=()=>{var e,s,t,n;A.length&&(N.push((e=C++,s=w,t=b,n=A,(0,i.jsxs)(c.A,{isOut:t,children:[!t&&(0,i.jsx)(u.euF,{className:m.A.Avatar,src:a?.[s]?.picUrl,size:32}),(0,i.jsx)(r.A,{isOut:t,children:n})]},v+e))),A=[])};for(let a=0;a<e.length;a++){const r=e[a],c=new Date(1e3*r.date),m=new Date(c.getFullYear(),c.getMonth(),c.getDate()).getTime();if($&&$!==m&&(T(),j.push((0,i.jsx)(n.A,{dateMs:$,children:N},$)),N=[]),$=m,"NewMessage"==r?.kind&&r.action){T(),N.push((0,i.jsx)(o.A,{message:r},y+r.conversation_message_id));continue}"NewMessage"==r?.kind&&0!=a&&r.from_id!==w&&(T(),w=r.from_id,b=!!r.out);const _=!A.length;if("NewMessage"==r?.kind){const e=()=>t?r.src?h.use("vkcom_messages_history_original_msg"):h.use("vkcom_messages_history_changed_msg",{date:window.getDateText(r.date,null)}):r.time?h.use("vkcom_messages_history_when_deleted",{time:window.getDateText(r.time,null)}):null;A.push((0,i.jsx)(u.m_M,{placement:b?"left":"right",appearance:"inversion",description:e(),children:(0,i.jsx)(l.A,{firstInStack:_,message:r})},`${y}${r.conversation_message_id}_${r.update_time||0}`))}else j.push((0,i.jsx)(x.A,{message:r,users:s},y+r.id))}return(A.length||N.length)&&(T(),j.push((0,i.jsx)(n.A,{dateMs:$,children:N},$))),(0,i.jsx)(d.Z,{children:(0,i.jsx)(u.YJl,{className:k.A.MessagesViewerGroup,children:(0,i.jsx)("div",{className:k.A.MessagesViewerGroup__history,children:j})})})};a()}catch(e){a(e)}})},48104:(e,s,t)=>{t.d(s,{A:()=>a});const a={Action:"D_4wYHYXuZcDW4os",Action__Text:"mA_NmgrZkTg7SH8h",Action__Link:"yQGtydVCLxRLnMW2"}},51466:(e,s,t)=>{t.d(s,{A:()=>c,_:()=>r});var a=t(81621);const i=window,n=(0,a.vt)(e=>({peerNames:i.peerNames,setPeerNames:s=>e({peerNames:s})})),r=e=>{n.getState().setPeerNames(e)},c=n},59154:(e,s,t)=>{t.d(s,{A:()=>a});const a={Avatar:"PEp_NqZqPfV0LaC0",MessagesViewer:"MKTeBw1zWt74LWe3",Pagination:"flLL09U_9hB92qFm",HistoryWrapper:"yTDwqDxH37eOLfx8"}},59813:(e,s,t)=>{t.d(s,{A:()=>_});var a=t(74848),i=t(87528);const n="xnJHUfyRoE7A8th_",r="PC7hnSXPn0hZ9PoL",c="rh0ztpNt0Osj6ueC";var o=t(39107),l=t(85692);const m={width:"100%",height:1,marginBottom:-1,visibility:"hidden"};const _=({dateMs:e,children:s})=>{const{sentinel:t,isSticky:_}=function(){const[e,s]=(0,l.Wx)({threshold:0});return{sentinel:(0,a.jsx)("div",{ref:e,style:m}),isSticky:!s}}(),d=(0,o.xWm)(r,_&&c);return(0,a.jsxs)("div",{children:[t,(0,a.jsx)("div",{className:n,children:(0,a.jsx)("span",{className:d,children:(0,i.H)(e)})}),s]})}},67685:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.d(s,{A:()=>l});var i=t(74848),n=t(30598),r=t(39107),c=t(87675),o=e([c]);c=(o.then?(await o)():o)[0];const l=({message:e,users:s,isEdit:t})=>{const a=(0,c.A)();return(0,i.jsxs)("div",{className:"im-mess-stack _im_mess_stack","data-peer":e.from_id,children:[(0,i.jsx)("div",{className:"im-mess-stack--photo",children:(0,i.jsx)("div",{className:"nim-peer nim-peer_small fl_l",children:(0,i.jsx)("div",{className:"nim-peer--photo-w",children:(0,i.jsx)("div",{className:"nim-peer--photo",children:(0,i.jsx)("a",{target:"_blank",className:"im_grid",rel:"noreferrer",href:"/"+s[e.from_id].screen_name,children:(0,i.jsx)("img",{alt:s[e.from_id].name,src:s[e.from_id].photo_50})})})})})}),(0,i.jsxs)("div",{className:"im-mess-stack--content",children:[(0,i.jsx)("div",{className:"im-mess-stack--info",children:(0,i.jsxs)("div",{className:"im-mess-stack--pname",children:[(0,i.jsx)("a",{href:"/"+s[e.from_id].screen_name,className:"im-mess-stack--lnk",target:"_blank",rel:"noreferrer",children:s[e.from_id].name}),(0,i.jsx)("span",{className:"im-mess-stack--tools",children:t?(0,i.jsx)("a",{href:`/im?sel=${e.peer_id}&msgid=${e.id}`,className:"_im_mess_link",rel:"noreferrer",children:e.src?a.use("vkcom_messages_history_original_msg"):a.use("vkcom_messages_history_changed_msg",{date:window.getDateText(e.date,null)})}):(0,i.jsx)(r.m_M,{appearance:"inversion",description:e.time&&a.use("vkcom_messages_history_when_deleted",{time:window.getDateText(e.time,null)}),children:(0,i.jsx)("a",{href:`/im?sel=${e.peer_id}&msgid=${e.id}`,className:"_im_mess_link",rel:"noreferrer",children:window.getDateText(e.date,null)})})})]})}),(0,i.jsx)("ul",{className:"ui_clean_list im-mess-stack--mess _im_stack_messages",children:(0,i.jsx)("li",{className:`im-mess _im_mess _im_mess_noa im-mess_editable _im_mess_${e.id}`,"aria-hidden":"false","data-deleted":!0,"data-ts":e.date,"data-msgid":e.id,"data-peer":e.peer_id,style:{cursor:"default"},children:(0,i.jsx)("div",{className:"im-mess--text wall_module _im_log_body",dangerouslySetInnerHTML:{__html:[e.reply,(0,n.A)(e.text,{mentions:1,allMentions:1,mail:1,link:1,emoji:1}),e.attachments].join("")}})})})]})]},e.id)};a()}catch(e){a(e)}})},69986:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.d(s,{A:()=>c});var i=t(51603),n=t(26690),r=t(81621);const e=new n.LangReact(await(0,i.A)("chatHistory",0)),c=(0,r.vt)()(()=>({lang:e,code:-1}));a()}catch(e){a(e)}},1)},76299:(e,s,t)=>{t.d(s,{A:()=>n});var a=t(99418);const i=document.createElement("textarea"),n=e=>(i.innerText=a.A.sanitize(e),i.innerHTML)},82827:(e,s,t)=>{t.d(s,{Q:()=>r});var a=t(81621),i=t(59914);const n=(0,a.vt)()(e=>({snackbar:null,showSnackbar:s=>{e({snackbar:s})},hideSnackbar:()=>{e({snackbar:null})}})),r=()=>n((0,i.k)(e=>({showSnackbar:e.showSnackbar,hideSnackbar:e.hideSnackbar})))},84833:(e,s,t)=>{t.d(s,{A:()=>c});var a=t(74848),i=t(39107),n=t(96540),r=t(17100);const c=({children:e,noClose:s=!1,...t})=>{const{open:c,setOpen:o,onClose:l,onClosed:m,onOpen:_,onOpened:d}=(0,r.Fs)(),h=(0,n.useId)();return(0,a.jsx)(i.VWm,{nav:h,open:c,onClose:(e,t)=>{s||(o(!1),l?.(e,t))},onClosed:m,onOpen:_,onOpened:d,...t,children:(0,a.jsx)(n.Suspense,{fallback:(0,a.jsx)(i.qBl,{}),children:e})})}},88496:(e,s,t)=>{t.d(s,{A:()=>c});var a=t(74848),i=t(39107);const n="mZ8HhZVyKRXwp3ds",r="KYP7yyNNCooJeOGi",c=({isOut:e,children:s})=>{const t=(0,i.xWm)(n,e&&r);return(0,a.jsx)("div",{className:t,children:s})}},89230:(e,s,t)=>{t.d(s,{A:()=>n});var a=t(74848),i=t(39107);const n=()=>(0,a.jsxs)("div",{className:"im-mess-stack _im_mess_stack",children:[(0,a.jsx)("div",{className:"im-mess-stack--photo",children:(0,a.jsx)("div",{className:"nim-peer nim-peer_small fl_l",children:(0,a.jsx)("div",{className:"nim-peer--photo-w",children:(0,a.jsx)("div",{className:"nim-peer--photo",children:(0,a.jsx)(i.EAD,{borderRadius:"50%",height:"36px"})})})})}),(0,a.jsxs)("div",{className:"im-mess-stack--content",children:[(0,a.jsx)("div",{className:"im-mess-stack--info",children:(0,a.jsx)("div",{className:"im-mess-stack--pname",children:(0,a.jsx)(i.EAD,{width:100})})}),(0,a.jsx)("ul",{className:"ui_clean_list im-mess-stack--mess _im_stack_messages",children:(0,a.jsx)("li",{className:"im-mess _im_mess _im_mess_noa im-mess_editable",style:{cursor:"default"},children:(0,a.jsx)("div",{className:"im-mess--text wall_module _im_log_body",children:(0,a.jsx)("span",{children:(0,a.jsx)(i.EAD,{width:200})})})})})]})]})},89749:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.d(s,{A:()=>p});var i=t(74848),n=t(98235),r=t(69986),c=t(51466),o=t(7618),l=t(39107),m=t(48104),_=e([r]);r=(_.then?(await _)():_)[0];const d=({peerName:e,peerUrl:s})=>(0,i.jsx)(l.N_E,{className:m.A.Action__Link,href:s,target:"_blank",children:(0,i.jsx)(h,{text:e})}),h=({text:e,onClick:s})=>(0,i.jsx)(l.EYj,{inline:!0,weight:"1",className:(0,l.xWm)(m.A.Action__Text,s&&m.A.Action__Link),onClick:s,useAccentWeight:!0,children:e}),u=(e,s,t=!1)=>{const a=e[s];let i="",n="",r=!1;return o.z.isUserId(s)?(i=t?a?.acc:a?.ins||`@id${s}`,n=`https://vk.ru/id${s}`):o.z.isGroupId(s)&&(i=a?.name||"@club"+-s,n="https://vk.ru/club"+-s,r=!0),{name:i,link:n,isCommunity:r}},p=({message:e})=>{const s=(0,c.A)(e=>e.peerNames),t=(0,r.A)(e=>e.lang),a=(0,n.A)({cmId:e.action?.conversation_message_id||0}),o=(e,s)=>{const a=t.use(e,s);return(0,i.jsx)("div",{className:m.A.Action,children:(0,i.jsx)(l.EYj,{inline:!0,className:m.A.Action__Text,children:a})})};if(!e.action)return null;switch(e.action.type){case"chat_photo_remove":case"chat_photo_update":case"chat_group_call_started":case"chat_invite_user_by_link":case"chat_screenshot":case"conversation_style_update":case"conversation_style_update_action":{const{name:t,link:a,isCommunity:n}=u(s,e.from_id);let r=`chathistory_action_${e.action.type}`;return n&&(r+="_community"),o(r,{user:(0,i.jsx)(d,{peerName:t,peerUrl:a})})}case"chat_unpin_message":case"chat_pin_message":{const{name:t,link:n,isCommunity:r}=u(s,e.from_id);let c=`chathistory_action_${e.action.type}`;e.action.message||(c+="_custom_text"),r&&(c+="_community");const l=e.action.message?(0,i.jsx)(h,{text:e.action.message,onClick:a}):(0,i.jsx)(h,{text:"сообщение",onClick:a});return o(c,{user:(0,i.jsx)(d,{peerName:t,peerUrl:n}),message:l})}case"chat_create":case"chat_title_update":{const{name:t,link:a,isCommunity:n}=u(s,e.from_id);let r=`chathistory_action_${e.action.type}`;return n&&(r+="_community"),o(r,{user:(0,i.jsx)(d,{peerName:t,peerUrl:a}),title:(0,i.jsx)(h,{text:e.action.text}),old_title:(0,i.jsx)(h,{text:e.action.old_text})})}case"chat_invite_user":case"chat_kick_user":{const{name:t,link:a,isCommunity:n}=u(s,e.from_id),{name:r,link:c}=u(s,e.action.member_id,!0);let l=`chathistory_action_${e.action.type}`;return e.action.member_id===e.from_id&&(l+="_self"),n&&(l+="_community"),o(l,{user:(0,i.jsx)(d,{peerName:t,peerUrl:a}),target:(0,i.jsx)(d,{peerName:r,peerUrl:c})})}case"chat_invite_user_by_message_request":case"chat_invite_user_by_call":case"chat_invite_user_by_call_join_link":case"chat_kick_user_call_block":case"accepted_message_request":{const{name:t,link:a,isCommunity:n}=u(s,e.from_id),{name:r,link:c}=u(s,e.action.member_id,!0);let l=`chathistory_action_${e.action.type}`;return n&&(l+="_community"),o(l,{user:(0,i.jsx)(d,{peerName:t,peerUrl:a}),target:(0,i.jsx)(d,{peerName:r,peerUrl:c})})}case"sent_message_requests_count":return o(`chathistory_action_${e.action.type}`,{num:e.action.count.toString()});case"chat_kick_don":case"call_transcription_failed":case"rejected_message_request":return o(`chathistory_action_${e.action.type}`,{});case"sent_message_request":{const{name:t,link:a}=u(s,e.from_id),{name:n,link:r}=u(s,e.action.member_id);return o(`chathistory_action_${e.action.type}`,{user:(0,i.jsx)(d,{peerName:t,peerUrl:a}),viewer:(0,i.jsx)(d,{peerName:n,peerUrl:r})})}case"custom":return(0,i.jsx)("span",{children:Array.isArray(e.action.chunks)?e.action.chunks.join(" "):JSON.stringify(e.action)});default:return o("me_unsupported_message",{})}};a()}catch(e){a(e)}})},94249:(e,s,t)=>{t.d(s,{Z:()=>o});var a=t(74848),i=t(39107),n=t(96540),r=t(62295);const c="Pab4lyLnWDTPLKdr",o=({children:e,height:s=537,style:t={},saveKey:o,isScrollBottom:l,ThumbVerticalClassName:m,..._})=>{const d=(0,n.useRef)(null);return(0,n.useEffect)(()=>{if(!o)return;if(!d.current)return;const e=(e=>{const s=sessionStorage.getItem(e);return s?parseFloat(s):null})(o);e&&d.current.scrollTop(e)},[o,d]),(0,n.useEffect)(()=>{l&&d.current&&d.current.scrollToBottom()}),(0,a.jsx)(r.ur,{ref:d,style:{height:s,...t},renderThumbVertical:e=>{var s,t;return o&&d.current&&(s=o,t=d.current.getScrollTop(),sessionStorage.setItem(s,t.toString())),(0,a.jsx)("div",{...e,className:(0,i.xWm)(c,m)})},renderTrackHorizontal:()=>(0,a.jsx)("div",{}),..._,children:e})}}}]);