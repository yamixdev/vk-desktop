"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[1180],{1003:(e,n,t)=>{t.d(n,{A:()=>o});const o=(e=window.location.pathname)=>{const n=e.match(/^\/?gim(\d+)/);return n&&n[1]?-parseInt(n[1]):window.vk.id}},7933:(e,n,t)=>{t.d(n,{A:()=>r});var o=t(93819),a=t(67078),s=t(10381),i=t(44497),c=t(25620);const r=(0,s.A)(async()=>{const e=window.cur?.peer||(0,i.A)();if(!e)return;const n=await o.A;await(0,a.A)({type:"done",text:(0,c.A)(e)?n.use("vkcom_toggle_write_on"):n.use("vkcom_toggle_write_off")})})},10381:(e,n,t)=>{t.d(n,{A:()=>s});var o=t(43027),a=t(89964);const s=e=>{let n,t,s=!1,i=null;const c=a=>{a.keyCode===n?s=!0:a.keyCode===t&&s&&((0,o.A)(a),e().catch(console.error))},r=e=>{e.keyCode===n&&(s=!1)},d=()=>{s=!1},l=()=>{document.removeEventListener("keydown",c),document.removeEventListener("keyup",r),window.removeEventListener("blur",d);for(const e of document.querySelectorAll(".ComposerInput__input,.ConvoComposer__input"))e.onkeydown=e.__oldKeyDown||null,e.onkeyup=e.__oldKeyUp||null,e.__oldKeyDown=null,e.__oldKeyUp=null;i&&(i(),i=null)};return{enable:(e,o)=>{l(),n=e,t=o,document.addEventListener("keydown",c),document.addEventListener("keyup",r),window.addEventListener("blur",d),i=(0,a.A)(e=>{for(const n of e.querySelectorAll(".ComposerInput__input,.ConvoComposer__input"))n.__oldKeyDown||n.__oldKeyUp||(n.__oldKeyDown=n.onkeydown,n.__oldKeyUp=n.onkeyup,n.onkeydown=function(e){c(e),n.__oldKeyDown&&n.__oldKeyDown(e)},n.onkeyup=function(e){r(e),n.__oldKeyUp&&n.__oldKeyUp(e)})})},disable:l}}},24884:(e,n,t)=>{t.d(n,{A:()=>a});var o=t(25012);const a=(0,t(10381).A)(async()=>(0,o.A)())},25012:(e,n,t)=>{t.d(n,{A:()=>s});var o=t(7618),a=t(1003);const s=()=>{const e=(0,a.A)(),n=o.z.isGroupId(e)?`[club${Math.abs(e)}|`:`[id${e}|`,t=document.body.querySelector("input#im_history_search");if(t){t.value=n;const e=document.body.getElementsByClassName("im-search--btn _im_start_inplace_search")[0];e?.click();const o=document.body.getElementsByClassName("im-action im-action_search")[0];return o?.click(),void(t.value="")}if(window.vkmeIntegration){const e={...window.nav.objLoc,search:n};window.nav.go(e)}}},25162:(e,n,t)=>{t.d(n,{A:()=>o});const o=(0,t(10381).A)(async()=>{const e=window.ap;e&&(e.isPlaying()?e.pause():e.play())})},25620:(e,n,t)=>{t.d(n,{A:()=>i});var o=t(52968),a=t(43024),s=t(37573);const i=e=>{"string"==typeof e&&(e=parseInt(e));const n=Math.abs((0,o.A)()),t=a.default.getValue("silentwriteinclgim"),i=a.default.getValue("silentwriteexclgim");let c=t[n]||[],r=i[n]||[],d=!1;return n||(c=a.default.getValue("silentwriteincl"),r=a.default.getValue("silentwriteexcl")),(0,s.A)(e,n)?(c.includes(e)&&c.splice(c.indexOf(e),1),r.includes(e)||r.push(e),d=!1):(r.includes(e)&&r.splice(r.indexOf(e),1),c.includes(e)||c.push(e),d=!0),n?(t[n]=c,i[n]=r,a.default.setValue("silentwriteinclgim",t),a.default.setValue("silentwriteexclgim",i)):(a.default.setValue("silentwriteincl",c),a.default.setValue("silentwriteexcl",r)),d}},26185:(e,n,t)=>{t.d(n,{A:()=>a});var o=t(43024);const a=(0,t(10381).A)(async()=>{o.default.setValue("casper",!o.default.getValue("casper"))})},28381:(e,n,t)=>{t.d(n,{A:()=>s});var o=t(92046),a=t(44497);const s=async(e=(0,a.A)())=>{if(!e||0===e)return;const{items:n}=await vkApi.api("messages.getHistory",{peer_id:e||window.cur.peer||window.vk.id,count:1,rev:1}),t=n[0].conversation_message_id||1;if(window.vkmeIntegration){const e={...window.nav.objLoc,cmid:`${t}`};window.nav.go(e)}else{const e={...window.nav.objLoc},{sel:n}=e;window.nav.go({...e,sel:""}),await(0,o.c)(0),window.nav.go({...e,sel:n,msgid:t})}}},40524:(e,n,t)=>{t.d(n,{A:()=>a});var o=t(43024);const a=(0,t(10381).A)(async()=>{const e=o.default.getValue("currentTheme");e===o.default.getValue("firstTheme")||void 0===e?o.default.setValue("currentTheme",o.default.getValue("secondTheme")):o.default.setValue("currentTheme",o.default.getValue("firstTheme"))})},44497:(e,n,t)=>{t.d(n,{A:()=>o});const o=()=>{const e=window.location.pathname.match(/\/convo\/(-?\d+)/);if(e)return Number(e[1])||0;const n=new URLSearchParams(window.location.search),t=Number(n.get("sel"));return t||0}},47885:(e,n,t)=>{t.d(n,{A:()=>o});const o=(0,t(10381).A)(async()=>{const e=window.ap;e&&e.playPrev()})},52968:(e,n,t)=>{t.d(n,{A:()=>s});var o=t(7618),a=t(1003);const s=()=>{if(window.cur.gid&&o.z.isGroupId(window.cur.gid))return window.cur.gid;const e=(0,a.A)();return o.z.isGroupId(e)?e:0}},62708:(e,n,t)=>{t.d(n,{A:()=>i});var o=t(22440),a=t(10381);const s=(0,o.A)(),i=(0,a.A)(async()=>{s.nav.go({...s.nav.objLoc,sel:s.vk.id+""})})},65123:(e,n,t)=>{t.d(n,{A:()=>i});var o=t(52968),a=t(43024),s=t(11860);const i=e=>{"string"==typeof e&&(e=parseInt(e));const n=Math.abs((0,o.A)()),t=a.default.getValue("silentreadinclgim"),i=a.default.getValue("silentreadexclgim");let c=t[n]||[],r=i[n]||[],d=!1;return n||(c=a.default.getValue("silentreadincl"),r=a.default.getValue("silentreadexcl")),(0,s.A)(e,n)?(c.includes(e)&&c.splice(c.indexOf(e),1),r.includes(e)||r.push(e),d=!1):(r.includes(e)&&r.splice(r.indexOf(e),1),c.includes(e)||c.push(e),d=!0),n?(t[n]=c,i[n]=r,a.default.setValue("silentreadinclgim",t),a.default.setValue("silentreadexclgim",i)):(a.default.setValue("silentreadincl",c),a.default.setValue("silentreadexcl",r)),d}},66133:(e,n,t)=>{t.a(e,async(e,o)=>{try{t.r(n);var a=t(57580),s=t(43024),i=t(79507),c=t(40524),r=t(87549),d=t(7933),l=t(76211),u=t(26185),g=t(24884),A=t(97761),y=t(62708),p=t(47885),h=t(88161),w=t(25162),m=e([a]);a=(m.then?(await m)():m)[0];const v=()=>{const e=s.default.getValue("hotKeys")||{};e.changeTheme&&c.A.enable(e.changeTheme.key,e.changeTheme.code),e.hideAvatar&&u.A.enable(e.hideAvatar.key,e.hideAvatar.code),e.changeUnreader&&r.A.enable(e.changeUnreader.key,e.changeUnreader.code),e.changeUnwriter&&d.A.enable(e.changeUnwriter.key,e.changeUnwriter.code),e.stopMusic&&w.A.enable(e.stopMusic.key,e.stopMusic.code),e.nextMusic&&A.A.enable(e.nextMusic.key,e.nextMusic.code),e.previousMusic&&p.A.enable(e.previousMusic.key,e.previousMusic.code),e.goToBeginChat&&l.A.enable(e.goToBeginChat.key,e.goToBeginChat.code),e.myMentions&&g.A.enable(e.myMentions.key,e.myMentions.code),e.readCurChat&&h.A.enable(e.readCurChat.key,e.readCurChat.code),e.openFavorites&&y.A.enable(e.openFavorites.key,e.openFavorites.code),e.changeKeyboard&&i.A.enable(e.changeKeyboard.key,e.changeKeyboard.code)},f=()=>{s.default.addChangeKeyListener("hotKeys",(e,n)=>{if(JSON.stringify(e)===JSON.stringify(n))return;const t=n||{};t.changeTheme?c.A.enable(t.changeTheme.key,t.changeTheme.code):c.A.disable(),t.hideAvatar?u.A.enable(t.hideAvatar.key,t.hideAvatar.code):u.A.disable(),t.changeUnreader?r.A.enable(t.changeUnreader.key,t.changeUnreader.code):r.A.disable(),t.changeUnwriter?d.A.enable(t.changeUnwriter.key,t.changeUnwriter.code):d.A.disable(),t.stopMusic?w.A.enable(t.stopMusic.key,t.stopMusic.code):w.A.disable(),t.nextMusic?A.A.enable(t.nextMusic.key,t.nextMusic.code):A.A.disable(),t.previousMusic?p.A.enable(t.previousMusic.key,t.previousMusic.code):p.A.disable(),t.goToBeginChat?l.A.enable(t.goToBeginChat.key,t.goToBeginChat.code):l.A.disable(),t.myMentions?g.A.enable(t.myMentions.key,t.myMentions.code):g.A.disable(),t.readCurChat?h.A.enable(t.readCurChat.key,t.readCurChat.code):h.A.disable(),t.openFavorites?y.A.enable(t.openFavorites.key,t.openFavorites.code):y.A.disable(),t.changeKeyboard?i.A.enable(t.changeKeyboard.key,t.changeKeyboard.code):i.A.disable()})},b=()=>{try{v()}catch(e){console.error(e)}f()};0,s.default.onInited(b),o()}catch(e){o(e)}})},67078:(e,n,t)=>{t.d(n,{A:()=>c});var o=t(74848),a=t(3068),s=t(75511);const i=document.createElement("div");i.className=s.A.Snackbars;const c=async e=>{const n=(await Promise.all([t.e(961),t.e(7397),t.e(1649),t.e(8414),t.e(5812)]).then(t.bind(t,25812))).default;document.body.contains(i)||document.body.appendChild(i);const s=document.createElement("div");i.appendChild(s);const{unmount:c}=await(0,a.A)({root:s,content:(0,o.jsx)(n,{onClose:()=>{c(),s.remove(),0===i.children.length&&i.remove()},...e}),disableParentTransformForPositionFixedElements:!0,noStyling:!0})}},75511:(e,n,t)=>{t.d(n,{A:()=>o});const o={Snackbars:"fuEF5ymRhcBAxInE",BaseSnackbar:"Fu47p889xWCKEooV"}},76211:(e,n,t)=>{t.d(n,{A:()=>s});var o=t(44497),a=t(28381);const s=(0,t(10381).A)(async()=>(0,a.A)(window.cur.peer||(0,o.A)()))},79507:(e,n,t)=>{t.d(n,{A:()=>r});var o=t(10381);const a=e=>{if(e instanceof HTMLInputElement)return e.selectionStart||0;const n=document.getSelection(),t=n?.getRangeAt(0),o=t?.cloneRange();o?.selectNodeContents(e),o?.setEnd(t?.startContainer,t?.startOffset);return o?.toString().length||0},s=(e,n)=>{if(e instanceof HTMLInputElement)e.setSelectionRange(n,n),e.focus();else{const t=window.getSelection(),o=document.createRange(),a=(e,n)=>{if(e.nodeType===Node.TEXT_NODE)e.textContent.length>=n?(o.setStart(e,n),o.setEnd(e,n)):n-=e.textContent.length;else for(let t=0;t<e.childNodes.length;t++){const o=e.childNodes[t];a(o,n)}};a(e,n),t&&o&&(t.removeAllRanges(),t.addRange(o)),e.focus()}};const i=new class{map;reverseMap;constructor(e){this.map=e,this.reverseMap={};for(const n in e)this.reverseMap[e[n]]=n}get(e){return this.map[e]||this.reverseMap[e]||e}}({"`":"ё",q:"й",w:"ц",e:"у",r:"к",t:"е",y:"н",u:"г",i:"ш",o:"щ",p:"з","[":"х","]":"ъ",a:"ф",s:"ы",d:"в",f:"а",g:"п",h:"р",j:"о",k:"л",l:"д",";":"ж","'":"э",z:"я",x:"ч",c:"с",v:"м",b:"и",n:"т",m:"ь",",":"б",".":"ю","/":".","~":"Ё",Q:"Й",W:"Ц",E:"У",R:"К",T:"Е",Y:"Н",U:"Г",I:"Ш",O:"Щ",P:"З","{":"Х","}":"Ъ",A:"Ф",S:"Ы",D:"В",F:"А",G:"П",H:"Р",J:"О",K:"Л",L:"Д",":":"Ж",'"':"Э",Z:"Я",X:"Ч",C:"С",V:"М",B:"И",N:"Т",M:"Ь","<":"Б",">":"Ю","?":",","@":'"',"#":"№",$:";","^":":","&":"?","|":"/"}),c=e=>e.split("").reduce((e,n)=>e+i.get(n),""),r=(0,o.A)(async()=>{const e=document.activeElement;if(!e)return;if(e instanceof HTMLElement&&e.isContentEditable&&e.innerText&&1===e.childNodes.length){const n=a(e),t=e.innerText;return e.innerText=c(t),void s(e,n)}if(e instanceof HTMLInputElement&&"value"in e){const n=e.selectionStart||0,t=e.selectionEnd||0;return e.value=c(e.value),s(e,n),void e.setSelectionRange(n,t)}const n=a(e);for(const n of e.childNodes)n.nodeType===Node.TEXT_NODE&&n.textContent&&(n.textContent=c(n.textContent));s(e,n)})},87549:(e,n,t)=>{t.d(n,{A:()=>r});var o=t(93819),a=t(67078),s=t(10381),i=t(44497),c=t(65123);const r=(0,s.A)(async()=>{const e=window.cur?.peer||(0,i.A)();if(!e)return;const n=await o.A;await(0,a.A)({type:"done",text:(0,c.A)(e)?n.use("vkcom_toggle_read_on"):n.use("vkcom_toggle_read_off")})})},88161:(e,n,t)=>{t.d(n,{A:()=>c});var o=t(93819),a=t(52968),s=t(44497),i=t(67078);const c=(0,t(10381).A)(async()=>{const e=window.cur?.peer||(0,s.A)(),n=await o.A;if(!e)return await(0,i.A)({type:"error",text:n.use("vkcom_error_vk_api")});try{await window.vkApi.api("messages.markAsRead",{peer_id:e,group_id:(0,a.A)()}),await(0,i.A)({type:"done",text:n.use("global_done")})}catch(e){console.error(e),await(0,i.A)({type:"error",text:e?.error?.error_msg||n.use("global_error")})}})},97761:(e,n,t)=>{t.d(n,{A:()=>o});const o=(0,t(10381).A)(async()=>{const e=window.ap;e&&e.playNext()})}}]);