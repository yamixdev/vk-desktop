"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[119],{119:(e,t,s)=>{s.a(e,async(e,r)=>{try{s.r(t);var n=s(57580),o=s(99381),a=s(52968),c=s(65879),d=s(5679),i=s(11860),p=s(37573),u=s(43024),l=e([n]);n=(l.then?(await l)():l)[0];const w=new Set,h=new Map;(0,d.A)(e=>{switch(e.type){case"UserChangedConvo":"mark_read"===e?.userAction&&(w.add(e.peerId),h.has(e.peerId)||h.set(e.peerId,setTimeout(()=>{w.delete(e.peerId),h.delete(e.peerId)},1500)));break;case"UserSeenMessages_ThrottleTimedOut":case"UserSeenMessages_RequestCompleted":case"UserSeenMessages":if((0,i.A)(e.peerId,Math.abs((0,a.A)())))return!0;break;case"UserPlayedMessage_RequestCompleted":case"UserPlayedMessage":if(u.default.getValue("silentListen"))return!0}return!1});const g=e=>{if(e?._actAppHooked)return;e._actAppHooked=!0;const t=e.browserEnv.api.fetch;e.browserEnv.api.fetch=function(e,s,...r){let n=!1;return"messages.setActivity"===e&&(0,p.A)(s?.peer_id,s?.group_id)&&(n=!0),"messages.markAsRead"===e&&!w.has(s?.peer_id)&&(0,i.A)(s?.peer_id,s?.group_id)&&(n=!0),n?new Promise(o.A):Reflect.apply(t,this,[e,s,...r])}};0,(async()=>{g(await(0,c.A)())})().catch(console.error),r()}catch(e){r(e)}})},1003:(e,t,s)=>{s.d(t,{A:()=>r});const r=(e=window.location.pathname)=>{const t=e.match(/^\/?gim(\d+)/);return t&&t[1]?-parseInt(t[1]):window.vk.id}},5679:(e,t,s)=>{s.d(t,{A:()=>d});var r=s(51018),n=s(65879);const o=new r.e,a=new r.e,c=async()=>{(e=>{if(e._meAppHooked)return;e._meAppHooked=!0;const t=e.store.dispatch;let s=e.store.getState()?.ownerId;e.store.dispatch=function(...r){const[n]=r;s||(s=e.store.getState()?.ownerId);let c=!1;for(const e of a.listeners)try{const t=e(n);"boolean"==typeof t&&t&&(c=!0)}catch(e){console.error(e)}if(c)return;const d=Reflect.apply(t,e.store,r);for(const e of o.listeners)try{e(n)}catch(e){console.error(e)}return d}})(await(0,n.A)())},d=(e,t=!1)=>{const s=(t?o:a).addListener(e);return c(),s}},52968:(e,t,s)=>{s.d(t,{A:()=>o});var r=s(7618),n=s(1003);const o=()=>{if(window.cur.gid&&r.z.isGroupId(window.cur.gid))return window.cur.gid;const e=(0,n.A)();return r.z.isGroupId(e)?e:0}}}]);