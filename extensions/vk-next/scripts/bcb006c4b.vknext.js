"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[5560,5896],{9453:(e,t,n)=>{n.d(t,{A:()=>o});const o={VidPopover__content:"_HSvZOAY5tIpoGx1",VidBlock__preview:"AkNPPF1XvnhMn36O"}},15609:(e,t,n)=>{n.d(t,{A:()=>c});var o=n(74848),a=n(75623),s=n(39107);const i="j5noyirksU4hOAMT",r="FT_f_JIawX_phtyc",c=({children:e})=>(0,o.jsx)(a.A,{trigger:"click",placement:"top-start",usePortal:document.body,shown:!0,defaultShown:!0,disableCloseOnClickOutside:!0,disableCloseOnEscKey:!0,content:e,className:i,children:(0,o.jsx)(s.s6o,{className:r})})},21185:(e,t,n)=>{n.d(t,{A:()=>r});var o=n(96540),a=n(74225),s=n.n(a),i=n(88908);const r=e=>{const[t,n]=(0,o.useState)(!0),[a,r]=(0,o.useState)(null);return s()(async t=>{if(!t())return;n(!0),r(null);const o=(0,i.A)(e).trim(),a=await window.vkApi.api("video.search",{q:o,count:50,extended:1});t()&&(a&&r(a.items),n(!1))},[e]),{isLoading:t,items:a}}},21484:(e,t,n)=>{n.d(t,{A:()=>a});var o=n(87137);function a(e){const t=[];return t.push((0,o.A)(Math.floor(e%60))),t.push((0,o.A)(Math.floor(e/60)%60)),e/3600&&t.push(Math.floor(e/3600)),t.reverse().join(":")}},25896:(e,t,n)=>{n.a(e,async(e,o)=>{try{n.r(t),n.d(t,{default:()=>g});var a=n(74848),s=n(39107),i=n(96540),r=n(87675),c=n(15609),d=n(32366),l=n(9349),u=n(68196),h=n(9453),m=n(21185),w=e([r,u]);[r,u]=w.then?(await w)():w;const f=400,v=450,A=({children:e})=>(0,a.jsx)(s.guY,{className:h.A.VidPopover__content,style:{maxHeight:v,width:f},children:e}),p=({query:e})=>{const t=(0,r.A)(),{isLoading:n,items:o}=(0,m.A)(e),[c,h]=(0,i.useState)(!1);(0,i.useEffect)(()=>{null!==!o&&h(!1)},[o]);if(c)return(0,a.jsx)(s.OrA,{style:{width:f,height:v},children:t.use("vkcom_inline_sent")});if(n)return(0,a.jsx)(A,{children:(0,a.jsx)("div",{children:new Array(9).fill(1).map((e,t)=>(0,a.jsx)(u.A.Skeleton,{},t))})});return!(null===o)&&o.length>0?(0,a.jsx)(A,{children:(0,a.jsx)("div",{children:o.map(e=>(0,a.jsx)(u.A,{item:e,onClick:()=>(async e=>{h(!0),(0,d.A)(e),h(!1),(0,l.e8)()})(e)},`${e.owner_id}_${e.id}`))})}):(0,a.jsx)(s.OrA,{style:{width:f,height:v},children:t.use("global_not_found")})},g=({query:e})=>(0,a.jsx)(c.A,{children:(0,a.jsx)(p,{query:e})});o()}catch(e){o(e)}})},32366:(e,t,n)=>{n.d(t,{A:()=>u});var o=n(21484),a=n(92046),s=n(85560),i=n(93819),r=n(65879),c=n(44497),d=n(43024),l=n(43139);const u=async e=>{const t=await i.A;if(document.getElementById("reforged-root")){const n=(0,c.A)(),{store:o}=await(0,r.A)();o.dispatch({peerId:n,type:"UserChangedComposerDraft",kind:"addAttaches",attaches:{videos:[{kind:"Video",id:e.id,ownerId:e.owner_id,duration:e.duration,width:e.width,height:e.height,image:e.image,title:e.title,views:e.views,files:e.files,type:e.type,player:e.player,canDownload:1,uploadDate:e.date,isFromMessage:!1}]}});const i=d.default.getValue("inlineRemoveWatermark"),u=(0,l.Mf)();(0,l.t$)();const h=document.querySelector(".ConvoComposer__input");return h&&(h.textContent=await(0,s.default)()&&i?"":`via [club207165415|${t.use("global_app_name")}]`),await(0,a.c)(500),void(u&&u.click())}return await new Promise(n=>{const a=`${e.owner_id}_${e.id}`,i=window.cur.lastAddMedia.onChange;window.cur.lastAddMedia.onChange=async function(...e){const o=e[0];if(window.cur.lastAddMedia.onChange=i,i.apply(this,e),"video"!==o)return;const a=(0,l.Ay)();a&&(a.classList.add("im-send-btn_audio"),a.classList.remove("im-send-btn_send"),a.classList.remove("im-send-btn_loading"),a.style.pointerEvents="");const r=d.default.getValue("inlineRemoveWatermark"),c=document.getElementsByClassName("im_editable")[0];if(c){const e=await(0,s.default)()&&r?"":`via [club207165415|${t.use("global_app_name")}]`;c.setValue(e),window.Emoji.editableFocus(c,!1,!0)}a&&a.click(),n(!0)},window.cur.lastAddMedia.chooseMedia("video",a,{duration:(0,o.A)(e.duration),external:`99:${a}`,platform:"",preview:'<a class="VideoPreview"></a>',ratio:1.771987,title:e.title,thumb:e.image?.[0]?.url,raw_id:a,should_stretch:!1,from_ext_page:0})})}},44497:(e,t,n)=>{n.d(t,{A:()=>o});const o=()=>{const e=window.location.pathname.match(/\/convo\/(-?\d+)/);if(e)return Number(e[1])||0;const t=new URLSearchParams(window.location.search),n=Number(t.get("sel"));return n||0}},61166:(e,t,n)=>{n.d(t,{A:()=>o});const o={PopoverReforged:"V5vFILKwsuTAoDXp","reforged-anim-fade-in":"aKnVnnmt_OsWj600","reforged-anim-fade-out":"uvPWUxQQgpV6cgFC","PopoverReforged--noBackground":"h4DVtB6f3FyJCExI"}},68196:(e,t,n)=>{n.a(e,async(e,o)=>{try{n.d(t,{A:()=>m});var a=n(74848),s=n(39107),i=n(21484),r=n(8257),c=n(87675),d=n(9453),l=e([c]);c=(l.then?(await l)():l)[0];const u=({item:e,onClick:t})=>{const n=(0,c.A)();return(0,a.jsx)(s.T6P,{subtitle:(0,a.jsxs)(a.Fragment,{children:[(0,i.A)(e.duration)," • ",(0,r.A)(e.views)," ",e.views>1e3?n.use("vkcom_content_video_desc",null,"raw")[2]:n.use("vkcom_content_video_desc",e.views)]}),before:(0,a.jsx)(s._V3,{className:d.A.VidBlock__preview,src:e.image?.[0]?.url}),onClick:t,children:e.title})},h=()=>(0,a.jsx)(s.T6P,{subtitle:(0,a.jsx)(s.EAD,{width:150}),before:(0,a.jsx)(s._V3,{className:d.A.VidBlock__preview}),children:(0,a.jsx)(s.EAD,{width:200})});u.Skeleton=h;const m=u;o()}catch(e){o(e)}})},74225:(e,t,n)=>{var o=n(96540);function a(e,t,n){var a="function"==typeof t;o.useEffect(function(){var n,o=!0,s=e(function(){return o});return Promise.resolve(s).then(function(e){n=e}),function(){o=!1,a&&t(n)}},a?n:t)}e.exports=a,e.exports.useAsyncEffect=a},75623:(e,t,n)=>{n.d(t,{A:()=>r});var o=n(74848),a=n(39107),s=n(96540),i=n(61166);const r=({hideOnClick:e=!1,noBackground:t=!1,mode:n,onClick:r,onShownChange:c,className:d,contentWrapperClassName:l,shown:u,content:h,...m})=>{const[w,f]=(0,s.useState)(!1),v=(0,s.useRef)(null),A=(0,s.useRef)(null),p=(0,s.useCallback)(e=>{e?f(!0):v.current=setTimeout(()=>{f(!1)},100),c?.(e)},[n,c,f]);return(0,s.useEffect)(()=>{"boolean"==typeof u&&p(u)},[u,p]),(0,o.jsx)(a.AMh,{shown:w,className:(0,a.xWm)(i.A.PopoverReforged,t&&i.A["PopoverReforged--noBackground"],d),onShownChange:p,onClick:e=>{if("side"===n&&v.current)clearTimeout(v.current);else try{r?.(e)}catch(e){console.error(e)}},content:(0,o.jsx)("div",{ref:A,className:(0,a.xWm)(l),onClick:t=>{e&&A.current?.contains(t.target)&&f(!1)},children:h}),...m})}},85560:(e,t,n)=>{n.d(t,{default:()=>s});var o=n(79384),a=n(52815);const s=async()=>{const e=await(0,a.A)(),t=(0,o.A)(e[0][1]),n=(0,o.A)(e[1][1]);return!!(107<=t&&t<=110&&107<=n&&n<=110)}},87137:(e,t,n)=>{n.d(t,{A:()=>o});const o=e=>((e=e.toString()).length<2?"0":"")+e},87675:(e,t,n)=>{n.a(e,async(e,o)=>{try{n.d(t,{A:()=>s});var a=n(93819);const e=await a.A,s=()=>e;o()}catch(e){o(e)}},1)},88908:(e,t,n)=>{n.d(t,{A:()=>a});const o=document.createElement("textarea"),a=e=>(o.innerHTML=e,o.innerText)}}]);