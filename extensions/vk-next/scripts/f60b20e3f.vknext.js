"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[2392],{24293:(e,t,n)=>{var s,r;n.d(t,{h:()=>s}),(r=s||(s={})).PREPARING="preparing",r.DOWNLOADING="downloading",r.FINISHED="finished",r.ARCHIVING="archiving"},52079:(e,t,n)=>{e.exports=n(97273)},63989:(e,t,n)=>{n.d(t,{VZ:()=>s,fU:()=>o,oT:()=>r});class s extends Error{constructor(e){super(`Download task with ID ${e} not found.`),this.name="DownloadTaskNotFoundError"}}class r extends Error{constructor(e){super(`Download task with ID ${e} is already finished.`),this.name="DownloadTaskAlreadyFinishedError"}}class o extends Error{constructor(e){super(`Download task with ID ${e} has already timed out.`),this.name="DownloadTaskTimeoutError"}}},69106:(e,t,n)=>{n.d(t,{$:()=>a});var s=n(81621),r=n(24293),o=n(63989);const a=(0,s.vt)((e,t)=>{const n=e=>{const n=new Map(t().tasks).get(e);if(!n)throw new o.VZ(e);return n},s=t=>{e(e=>{const n=new Map(e.tasks),s=n.get(t);if(s?.onRemove)for(const e of s.onRemove)e();return n.delete(t),{tasks:n}})},a=a=>({setExtraText:t=>((t,s)=>{const r=n(t);e(e=>{const n=new Map(e.tasks);return n.set(t,{...r,extraText:s}),{tasks:n}})})(a,t),setPhotoUrl:t=>((t,s)=>{const r=n(t);e(e=>{const n=new Map(e.tasks);return n.set(t,{...r,photoUrl:s}),{tasks:n}})})(a,t),setTitle:t=>((t,s)=>{const r=n(t);e(e=>{const n=new Map(e.tasks);return n.set(t,{...r,title:s}),{tasks:n}})})(a,t),setProgress:s=>((s,a)=>{const u=n(s),i=new Map(t().tasks);if(u.status===r.h.FINISHED)throw new o.oT(s);e(()=>(i.set(s,{...u,progress:a,status:r.h.DOWNLOADING}),{tasks:i}))})(a,s),startArchiving:()=>(t=>{const s=n(t);e(e=>{const n=new Map(e.tasks);return n.set(t,{...s,status:r.h.ARCHIVING}),{tasks:n}})})(a),finish:t=>((t,a)=>{const u=n(t);if(u.status===r.h.FINISHED)throw new o.oT(t);if(u.timeoutId)throw new o.fU(t);const i=setTimeout(()=>s(t),60*(a?.onSave?15:5)*1e3);e(e=>{const n=new Map(e.tasks),s=new Set(u.onRemove);return a?.onRemove&&s.add(a.onRemove),n.set(t,{...u,onRemove:s,timeoutId:i,onSave:a?.onSave,status:r.h.FINISHED}),{tasks:n}})})(a,t),cancel:()=>(t=>{const s=n(t);for(const e of s.onCancel)e();e(e=>{const n=new Map(e.tasks);return n.delete(t),{tasks:n}})})(a),remove:()=>s(a)});return{tasks:new Map,startDownload:({id:t,onCancel:n,...s})=>{const o={...s,id:t,progress:{current:void 0,total:void 0},status:r.h.PREPARING,onCancel:new Set(n?[n]:[]),onRemove:new Set};e(e=>{const n=new Map(e.tasks);return n.set(t,o),{tasks:n}});const u=a(t);return{id:t,...u}},getTask:e=>{const t=n(e);return t?{...t}:void 0},getTaskHandlersById:a}})},72257:(e,t,n)=>{e.exports=n(72518)},72518:(e,t,n)=>{
/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var s=n(96540);var r="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=s.useState,a=s.useEffect,u=s.useLayoutEffect,i=s.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!r(e,n)}catch(e){return!0}}var l="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),s=o({inst:{value:n,getSnapshot:t}}),r=s[0].inst,l=s[1];return u(function(){r.value=n,r.getSnapshot=t,c(r)&&l({inst:r})},[e,n,t]),a(function(){return c(r)&&l({inst:r}),e(function(){c(r)&&l({inst:r})})},[e]),i(n),n};t.useSyncExternalStore=void 0!==s.useSyncExternalStore?s.useSyncExternalStore:l},81621:(e,t,n)=>{n.d(t,{vt:()=>f});const s=e=>{let t;const n=new Set,s=(e,s)=>{const r="function"==typeof e?e(t):e;if(!Object.is(r,t)){const e=t;t=(null!=s?s:"object"!=typeof r||null===r)?r:Object.assign({},t,r),n.forEach(n=>n(t,e))}},r=()=>t,o={setState:s,getState:r,getInitialState:()=>a,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},a=t=e(s,r,o);return o},r=e=>e?s(e):s;var o=n(96540),a=n(52079);const{useDebugValue:u}=o,{useSyncExternalStoreWithSelector:i}=a;let c=!1;const l=e=>e;const d=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t="function"==typeof e?r(e):e,n=(e,n)=>function(e,t=l,n){n&&!c&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),c=!0);const s=i(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return u(s),s}(t,e,n);return Object.assign(n,t),n},f=e=>e?d(e):d},82392:(e,t,n)=>{n.r(t);var s=n(74848),r=n(3068),o=n(69106);const a=document.createElement("li");let u;a.className="HeaderNav__item";o.$.subscribe(e=>{e.tasks.size>0?(async()=>{if(a.parentElement)return;const e=document.querySelector(".HeaderNav,#top_nav");if(e){const t=e.querySelector(".HeaderNav__audio");t?(t.insertAdjacentElement("afterend",a),a.style.order=""):(e.appendChild(a),a.style.order="-1")}else{const e=document.getElementById("page_header_wrap");if(!e)return void console.error("HeaderNav not found");const t=e.querySelector('[class*="TopNavigation__player--"]'),n=t?.nextElementSibling||e.querySelector(".vkuiFlexItem__flexGrow")||t;n?n.insertAdjacentElement("afterend",a):e.appendChild(a)}u&&u();const{default:t}=await Promise.all([n.e(961),n.e(7397),n.e(1649),n.e(8414),n.e(9451)]).then(n.bind(n,79451)),{unmount:o}=await(0,r.A)({root:a,content:(0,s.jsx)(t,{}),disableParentTransformForPositionFixedElements:!0,disablePortal:!0,wrapperProps:{style:{height:"100%"}}});u=o})():(a.remove(),u&&u())})},97273:(e,t,n)=>{
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var s=n(96540),r=n(72257);var o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=r.useSyncExternalStore,u=s.useRef,i=s.useEffect,c=s.useMemo,l=s.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,s,r){var d=u(null);if(null===d.current){var f={hasValue:!1,value:null};d.current=f}else f=d.current;d=c(function(){function e(e){if(!i){if(i=!0,a=e,e=s(e),void 0!==r&&f.hasValue){var t=f.value;if(r(t,e))return u=t}return u=e}if(t=u,o(a,e))return t;var n=s(e);return void 0!==r&&r(t,n)?(a=e,t):(a=e,u=n)}var a,u,i=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,n,s,r]);var v=a(e,d[0],d[1]);return i(function(){f.hasValue=!0,f.value=v},[v]),l(v),v}}}]);