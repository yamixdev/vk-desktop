"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[1654],{5679:(e,t,n)=>{n.d(t,{A:()=>l});var o=n(51018),s=n(65879);const r=new o.e,a=new o.e,i=async()=>{(e=>{if(e._meAppHooked)return;e._meAppHooked=!0;const t=e.store.dispatch;let n=e.store.getState()?.ownerId;e.store.dispatch=function(...o){const[s]=o;n||(n=e.store.getState()?.ownerId);let i=!1;for(const e of a.listeners)try{const t=e(s);"boolean"==typeof t&&t&&(i=!0)}catch(e){console.error(e)}if(i)return;const l=Reflect.apply(t,e.store,o);for(const e of r.listeners)try{e(s)}catch(e){console.error(e)}return l}})(await(0,s.A)())},l=(e,t=!1)=>{const n=(t?r:a).addListener(e);return i(),n}},9349:(e,t,n)=>{n.d(t,{Li:()=>c,e8:()=>i,f_:()=>a,ky:()=>d});var o=n(43171);const s=document.createElement("div");let r=null;const a=()=>{const e=document.querySelector(".Composer__inputPanel,.ConvoComposer__inputPanel");if(e)return void e.prepend(s);const t=document.querySelector(".im_editable");if(!t)throw new Error("Can't find editable");t.insertAdjacentElement("beforebegin",s)},i=()=>{r&&(r(),r=null,s.remove())};let l=!1;const c=e=>{r=e,l||(l=!0,(0,o.A)(()=>{i(),l=!1}))},d=()=>s},10010:(e,t,n)=>{n.d(t,{A:()=>o});const o=(e,t=500)=>{let n;return o=>{clearTimeout(n);const s=o.target;n=setTimeout(()=>{e(s.innerText)},t)}}},43139:(e,t,n)=>{n.d(t,{Ay:()=>l,Mf:()=>s,r1:()=>a,t$:()=>i});const o=()=>{const e=document.getElementsByClassName("_im_text_wrap")[0];return e?e.getElementsByClassName("im-send-btn")[0]:null},s=()=>document.querySelector(".DropdownReforged:not(.ConvoComposer__clip) .ConvoComposer__button");let r;const a=()=>{const e=s();if(e)return r=e.className,e.className="ConvoComposer__button ConvoComposer__sendButton--limit",void(e.style.pointerEvents="none");const t=o();t&&(t.classList.add("im-send-btn_loading"),t.style.pointerEvents="none")},i=()=>{const e=s();if(e&&r)return e.className=r,r=null,void(e.style.pointerEvents="");const t=o();t&&(t.classList.remove("im-send-btn_loading"),t.style.pointerEvents="")},l=o},92127:(e,t,n)=>{n.a(e,async(e,o)=>{try{n.r(t);var s=n(74848),r=n(57580),a=n(22707),i=n(37400),l=n(32488),c=n(3068),d=n(94169),u=n(43024),m=n(10010),p=n(43139),f=n(9349),y=e([r]);r=(y.then?(await y)():y)[0];const w=(e,t,n)=>!!u.default.getValue(e)&&(n=n.replace(/&nbsp;/g," ").trim(),t.toLowerCase()!==n.toLowerCase()&&(!!n.startsWith(t+" ")&&n.slice(t.length).trim())),v=async e=>{const t=u.default.getValue("inlineCommandPrefix");if(!t)return;const o=`${t}pic`,r=`${t}gif`,d=`${t}vid`,m=`${t}wiki`;await(0,i.G)(),await(0,a.t)();const y=w("useInlinePic",o,e);if(y&&y.length){(0,p.r1)();const e=(await Promise.all([n.e(961),n.e(7397),n.e(1649),n.e(9186)]).then(n.bind(n,39186))).default;(0,f.f_)();const{unmount:t}=await(0,c.A)({root:(0,f.ky)(),content:(0,s.jsx)(e,{query:y}),noStyling:!0,disableParentTransformForPositionFixedElements:!0,wrapperProps:{className:"styles.InlineCommandWrapper"}});return void(0,f.Li)(t)}const v=w("useInlineGif",r,e);if(v&&v.length&&await(0,l.default)()){(0,p.r1)();const e=(await Promise.all([n.e(961),n.e(7397),n.e(1649),n.e(8218)]).then(n.bind(n,68218))).default;(0,f.f_)();const{unmount:t}=await(0,c.A)({root:(0,f.ky)(),content:(0,s.jsx)(e,{query:v}),disablePortal:!0,disableParentTransformForPositionFixedElements:!0});return void(0,f.Li)(t)}const h=w("useInlineVid",d,e);if(h&&h.length&&await(0,l.default)()){(0,p.r1)();const e=(await Promise.all([n.e(961),n.e(7397),n.e(1649),n.e(5896)]).then(n.bind(n,25896))).default;(0,f.f_)();const{unmount:t}=await(0,c.A)({root:(0,f.ky)(),content:(0,s.jsx)(e,{query:h}),disablePortal:!0,disableParentTransformForPositionFixedElements:!0});return void(0,f.Li)(t)}const _=w("useInlineWiki",m,e);if(_&&_.length&&await(0,l.default)()){(0,p.r1)();const e=(await Promise.all([n.e(961),n.e(7397),n.e(1649),n.e(2130)]).then(n.bind(n,92130))).default;(0,f.f_)();const{unmount:t}=await(0,c.A)({root:(0,f.ky)(),content:(0,s.jsx)(e,{query:_}),disablePortal:!0,disableParentTransformForPositionFixedElements:!0});return void(0,f.Li)(t)}(0,p.t$)(),(0,f.e8)()},h=(0,m.A)(v,1e3),_=async()=>{for(const e of document.querySelectorAll(".ComposerInput,.ConvoComposer__input"))"1"!==e.dataset.hook&&(e.dataset.hook="1",await v(e.innerText),e.removeEventListener("input",h),e.addEventListener("input",h))},b=async()=>{await(0,a.t)(),window.location.pathname.startsWith("/im/convo/")&&_(),(0,d.A)(_)};0,u.default.onInited(b),o()}catch(e){o(e)}})},94169:(e,t,n)=>{n.d(t,{A:()=>c});var o=n(51018),s=n(5679);const r=new o.e,a=async e=>!!document.querySelector(".ConvoMain")&&(await(async e=>{for(const t of r.listeners)try{t?.(e)}catch(e){console.error(e)}})(e),!0);let i,l;(0,s.A)(async e=>{if("UserOpenedConvo"===e.type&&(i=e.peerId,!await a(e.peerId))){l&&clearTimeout(l);const t=setTimeout(async()=>{e.peerId===i?await a(e.peerId)&&clearTimeout(t):clearTimeout(t)},800);l=t}},!0);const c=e=>r.addListener(e)}}]);