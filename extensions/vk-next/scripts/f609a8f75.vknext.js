"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[5671],{7708:(e,t,a)=>{a.d(t,{A:()=>u});var s=a(74848),o=a(11157),r=a(39107),n=a(13742),c=a(68741),i=a(91691);const l="zRIhm_rzeRaOj2Bs",d="m8aAYX3glAEj5Q3G",u=({beforeClassname:e,backPage:t,hideButtonIsFirstPage:a,hideBackButtonInTablet:u,children:h,..._})=>{const p=(0,o.XC)(),w=(0,o.Gz)(),{width:f}=(0,n.A)();let m=a&&p&&(0,i.A)();return u&&(f||800)>768&&(m=!0),(0,s.jsx)(r.aOn,{before:!m&&(0,s.jsx)(r.Hy0,{onClick:async()=>{p?t?await w.replace(t):await w.push(c.JZ.root.main.home):await w.back()},className:(0,r.xWm)(l,e),hideLabelOnIOS:!0}),..._,children:(0,s.jsx)("div",{className:d,children:h})})}},17780:(e,t,a)=>{a.d(t,{A:()=>s});const s={captcha_container:"tooAYuDOMJrxejpu",captcha_input:"J_KaE7VRUfZ9T89l"}},19290:(e,t,a)=>{a.d(t,{A:()=>s});var s=(0,a(78414).mT)("Icon24HideOutline","hide_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="hide_outline_24"><path fill-rule="evenodd" d="M11.593 6.41a.9.9 0 0 1-.092-1.797c2.759-.141 5.574.953 7.649 2.5.975.728 1.787 1.554 2.356 2.396.57.843.894 1.7.894 2.49 0 .941-.464 1.982-1.242 2.967a.9.9 0 1 1-1.413-1.116c.41-.519.855-1.168.855-1.85 0-.312-.139-.822-.585-1.483-.436-.646-1.097-1.33-1.941-1.96-1.836-1.37-4.169-2.265-6.48-2.147ZM4.85 16.886C6.8 18.341 9.4 19.4 12 19.4c1.967 0 3.93-.607 5.604-1.523l1.26 1.26a.9.9 0 0 0 1.272-1.273l-13.5-13.5a.9.9 0 0 0-1.272 1.272l.684.684q-.63.37-1.198.794c-.975.727-1.787 1.553-2.356 2.395-.57.843-.894 1.7-.894 2.49s.325 1.65.894 2.492c.569.841 1.381 1.668 2.356 2.395M10.4 12a1.6 1.6 0 0 0 2.587 1.26l-2.247-2.247c-.213.272-.34.615-.34.987m1.6 3.4a3.4 3.4 0 0 1-2.537-5.664L7.37 7.643c-.513.273-.998.581-1.444.914-.844.63-1.505 1.314-1.94 1.96-.448.662-.586 1.17-.586 1.483 0 .312.138.821.585 1.483.436.645 1.097 1.33 1.941 1.96C7.631 16.715 9.862 17.6 12 17.6c1.44 0 2.925-.401 4.269-1.058l-2.005-2.005A3.4 3.4 0 0 1 12 15.4" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},45671:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{default:()=>y});var o=a(74848),r=a(79586),n=a(19290),c=a(64249),i=a(11157),l=a(39107),d=a(96540),u=a(82295),h=a(7708),_=a(1883),p=a(8015),w=a(68741),f=a(57087),m=a(92046),g=a(63898),v=a(17780),x=e([p]);p=(x.then?(await x)():x)[0];const k=({captchaImg:e,onSend:t})=>{const a=(0,p.A)(),[s,r]=(0,d.useState)(""),n=(0,d.useRef)(null);return(0,d.useEffect)(()=>{n.current&&n.current.focus()},[n]),(0,o.jsx)(l.V9m,{value:l.ODD.ANDROID,children:(0,o.jsx)(l.FcD,{actions:[{title:a.use("global_send"),mode:"default",action:()=>t(s)}],onClose:()=>t(s),title:a.use("settings_captcha_box_header"),description:(0,o.jsxs)("div",{className:v.A.captcha_container,children:[(0,o.jsx)("img",{src:e}),(0,o.jsx)(l.pde,{getRef:n,className:v.A.captcha_input,placeholder:a.use("settings_captcha_box_placeholder"),value:s,onChange:e=>{r(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&t(s)},maxLength:7})]})})})},j=()=>{const e=(0,p.A)(),t=(0,i.Gz)(),{showSnackbar:s,hideSnackbar:r}=(0,f.Qs)(),{forceUpdateAuthVKMe:h}=(0,f.De)(),_=(0,d.useRef)(null),w=(0,d.useRef)(null),v=(0,d.useRef)(null),[x,j]=(0,d.useState)(""),[y,b]=(0,d.useState)(!1),[C,A]=(0,d.useState)(!1),[S,P]=(0,d.useState)(""),[I,E]=(0,d.useState)(0),[R,T]=(0,d.useState)(""),[M,O]=(0,d.useState)(""),[D,K]=(0,d.useState)(""),[W,B]=(0,d.useState)(""),F=async e=>{if(!w.current)return;t.showPopout((0,o.jsx)(l.WHT,{}));const n=new URLSearchParams({client_id:"6146827",grant_type:"password",client_secret:"qVxWRF1CwHERuIrKBnqe",username:x,password:w.current?.value,scope:"all",v:"5.191","2fa_supported":"1",vk_connect_auth:"1"});S?.length&&n.set("code",S),e&&Object.entries(e).forEach(([e,t])=>{n.set(e,t)});const c=await(0,g.A)(`https://oauth.${u.A}/token?${n.toString()}`,{method:"POST"}),i=await c.json();try{const{checkCaptchaError:t,CheckCaptchaType:s}=await a.e(217).then(a.bind(a,90217)),{captchaType:o,captchaWidget:r}=t({responseHeaders:c.headers,url:c.url,responseError:"need_captcha"===i.error&&i.redirect_uri?{error_code:14,redirect_uri:i.redirect_uri}:void 0,withWidget:!0});if(o&&o!==s.UNKNOWN&&r)try{const t=await r.show({container:document.body,view:"popup"});return await F({...e,success_token:t})}catch(e){console.error(e)}}catch(e){console.error(e)}if(["invalid_request","invalid_client","9;Flood control","Flood control"].includes(i.error))return t.showPopout((0,o.jsx)(l.WHT,{state:"error"})),s((0,o.jsx)(l.qb_,{onClose:r,children:i.error_description})),await(0,m.c)(1e3),void t.hidePopout();if("need_validation"===i.error){const{API:e}=await Promise.resolve().then(a.bind(a,80894)),n=new e({getToken:async()=>"",onError:async(e,a)=>{t.showPopout((0,o.jsx)(l.WHT,{state:"error"})),s((0,o.jsx)(l.qb_,{onClose:r,children:a?.error_text||a?.error_msg||e.message})),await(0,m.c)(1e3),t.hidePopout()}});if("2fa_app"===i.validation_type)return E(6),T(i.validation_type),O(i.phone_mask),A(!0),void t.hidePopout();const{code_length:c,validation_type:d}=await n.auth.validatePhone({sid:i.validation_sid,supports_libverify:!1});return E(c),T(d),O(i.phone_mask),A(!0),void t.hidePopout()}if("need_captcha"===i.error&&(K(i.captcha_sid),B(i.captcha_img)),i.access_token){const{API:e}=await Promise.resolve().then(a.bind(a,80894)),s=new e({getToken:async()=>i.access_token}),{users_exchange_tokens:r}=await s.auth.getExchangeToken();for(const{common_token:e,user_id:s}of r){if(s!==i.user_id)continue;const r=(await a.e(9817).then(a.bind(a,69817))).default,n=await r.getStorage()||{};n[i.user_id]||(n[i.user_id]={}),n[i.user_id].vkMe={token:i.access_token,exchange_token:e},await r.setStorage(n),t.showPopout((0,o.jsx)(l.WHT,{state:"done"})),h(),await(0,m.c)(1e3),t.hidePopout(),t.back();break}}};return(0,d.useEffect)(()=>{_.current&&_.current.focus()},[]),(0,d.useEffect)(()=>{v.current&&v.current.focus()},[C]),(0,d.useEffect)(()=>{C&&S.length===I&&F().catch(console.error)},[S]),(0,d.useEffect)(()=>{D&&W&&t.showPopout((0,o.jsx)(k,{captchaImg:W,onSend:e=>{F({captcha_key:e,captcha_sid:D})}}))},[D,W]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.eIh,{children:(0,o.jsx)(l.pde,{disabled:C,getRef:_,type:"text",placeholder:e.use("settings_vkme_auth_placeholder"),autoComplete:"username",value:x,onChange:e=>{j(e.target.value)},onKeyDown:e=>{["Enter","ArrowDown"].includes(e.key)&&w.current?.focus()}})}),(0,o.jsx)(l.eIh,{children:(0,o.jsx)(l.pde,{disabled:C,getRef:w,autoComplete:"current-password",type:y?"text":"password",placeholder:e.use("settings_vkme_auth_password_placeholder"),after:(0,o.jsx)(l.K0,{onClick:()=>b(!y),children:y?(0,o.jsx)(n.A,{}):(0,o.jsx)(c.r,{})}),onKeyDown:e=>{"ArrowUp"===e.key&&_.current?.focus(),"Enter"!==e.key||C||F()}})}),C&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.iau,{children:(0,o.jsx)(l.lZ$,{title:"2fa_app"===R?e.use("settings_api_two_factor_validation_app"):"sms"===R?e.use("settings_api_two_factor_validation_sms",{phoneMask:M}):e.use("settings_api_two_factor_validation_msg")})}),(0,o.jsx)(l.eIh,{children:(0,o.jsx)(l.pde,{getRef:v,value:S,onChange:e=>P(e.target.value.trim()),placeholder:e.use("settings_vkme_auth_2fa_placeholder"),onKeyDown:e=>{"ArrowUp"===e.key&&w.current?.focus(),"Enter"===e.key&&F()}})})]}),(0,o.jsx)(l.eIh,{children:(0,o.jsx)(l.$nd,{size:"l",stretched:!0,onClick:()=>F(),children:e.use("settings_auth_confirm")})})]})},y=()=>{const e=(0,p.A)();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(h.A,{backPage:w.JZ.root.main.home,children:e.use("settings_menu_vkme_title")}),(0,o.jsxs)(_.A,{children:[(0,o.jsx)(l.OrA,{icon:(0,o.jsx)(r.i,{width:80,height:80})}),(0,o.jsx)(j,{})]})]})};s()}catch(e){s(e)}})},64249:(e,t,a)=>{a.d(t,{r:()=>s});var s=(0,a(78414).mT)("Icon24ViewOutline","view_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="view_outline_24"><path d="M12 4.6c5.2 0 10.4 4.237 10.4 7.4s-5.2 7.4-10.4 7.4S1.6 15.163 1.6 12 6.8 4.6 12 4.6m0 1.8c-4.278 0-8.6 3.522-8.6 5.6s4.322 5.6 8.6 5.6 8.6-3.522 8.6-5.6-4.322-5.6-8.6-5.6m0 2.2a3.4 3.4 0 1 1 0 6.8 3.4 3.4 0 0 1 0-6.8m0 1.8a1.6 1.6 0 1 0 0 3.2 1.6 1.6 0 0 0 0-3.2" /></symbol>',24,24,!1,void 0)},79586:(e,t,a)=>{a.d(t,{i:()=>n});var s=a(74848),o=a(96540),r=a(22185);const n=e=>{const t=o.useId();return(0,s.jsxs)(r.uC,{viewBox:"0 0 32 32",width:32,height:32,vkuiIconId:"logo_vk_me_color_32",vkuiAttrs:{fill:"none"},vkuiProps:e,children:[(0,s.jsx)("path",{fill:"#07f",d:"M3 15.48C3 9.597 3 6.655 4.828 4.828 6.655 3 9.597 3 15.48 3h1.04c5.883 0 8.825 0 10.652 1.828C29 6.655 29 9.597 29 15.48v1.04c0 5.883 0 8.825-1.828 10.652C25.345 29 22.403 29 16.52 29h-1.04c-5.883 0-8.825 0-10.652-1.828C3 25.345 3 22.403 3 16.52z"}),(0,s.jsx)("mask",{id:`logo_vk_me_color_32${t}a`,width:"26",height:"26",x:"3",y:"3",maskUnits:"userSpaceOnUse",style:{maskType:"alpha"},children:(0,s.jsx)("path",{fill:"#313131",d:"M3 15.36C3 9.535 3 6.62 4.81 4.81S9.534 3 15.36 3h1.28c5.826 0 8.74 0 10.55 1.81S29 9.534 29 15.36v1.28c0 5.826 0 8.74-1.81 10.55S22.466 29 16.64 29h-1.28c-5.826 0-8.74 0-10.55-1.81S3 22.466 3 16.64z"})}),(0,s.jsxs)("g",{mask:`url(#logo_vk_me_color_32${t}a)`,children:[(0,s.jsx)("path",{fill:"#00eaff",fillRule:"evenodd",d:"M31.855 12.62c.383-1.24.59-2.557.59-3.923 0-7.323-5.937-13.26-13.26-13.26S5.925 1.374 5.925 8.697c0 6.847 5.19 12.482 11.85 13.186v3.867c6.933-1.128 12.486-6.365 14.08-13.13",clipRule:"evenodd"}),(0,s.jsx)("path",{fill:"#fff",d:"M11.835 12.65a2.01 2.01 0 1 0 0-4.021 2.01 2.01 0 0 0 0 4.02M17.866 12.65a2.01 2.01 0 1 0 0-4.021 2.01 2.01 0 0 0 0 4.02M23.897 12.65a2.01 2.01 0 1 0 0-4.021 2.01 2.01 0 0 0 0 4.02"})]})]})}}}]);