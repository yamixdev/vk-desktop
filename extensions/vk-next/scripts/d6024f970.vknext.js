"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[7602],{7602:(e,t,o)=>{o.r(t);var n=o(37746),c=o(47812),r=o(37445),s=o(38729),i=o(28861),l=o(93819),a=o(43024),d=o(57448),u=o(62493);const h=(0,s.sr)(),m=async()=>{const[e]=(0,u.A)(),t=window.cur.pvCurPhoto?.id||"",o=a.default.getValue("keepOriginalPhotoNamesDownload");(0,n.A)(e,o?(0,d.A)(e):`photo${t}.jpg`)},p=async e=>{if(e.getElementsByClassName(h).length)return;const t=await l.A;if(e.querySelector(`#${h}`))return;const o=(0,i.h)(),n=(0,i.A)({id:h,text:t.use("global_download"),onClick:m,icon:r.A});e.appendChild(o),e.appendChild(n)};(0,c.P)().then(e=>{const t=e.prototype,o=t.show;t.show=function(...e){const t=Reflect.apply(o,this,e);try{for(const e of(this._ttel||document).querySelectorAll(".pv_more_acts"))p(e).then(()=>{this.updatePosition()}).catch(console.error)}catch(e){console.error(e)}return t}})},28861:(e,t,o)=>{o.d(t,{A:()=>s,h:()=>i});var n=o(53644);const c="XTtg3rbdke4fO2GH",r="O7g_ziCmsPZHi8tC",s=({text:e,icon:t,onClick:o,id:s})=>{const i=document.createElement("div");if(i.className="pv_more_act_item",s&&i.setAttribute("id",s),o&&i.addEventListener("click",o),t){const e=document.createElement("div");e.className=`pv_more_act_item_icon ${r}`,e.appendChild((0,n.A)(t)),i.appendChild(e),i.classList.add(c)}return i.appendChild(document.createTextNode(e)),i},i=({className:e,id:t}={})=>{const o=document.createElement("div");return o.classList.add("pv_more_act_item_sep"),t&&(o.id=t),e&&o.classList.add(e),o}},37445:(e,t,o)=>{o.d(t,{A:()=>n});const n='<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor"><path clip-rule="evenodd" d="m4 17.75c0-.4142.33579-.75.75-.75h10.5c.4142 0 .75.3358.75.75s-.3358.75-.75.75h-10.5c-.41421 0-.75-.3358-.75-.75z" fill-rule="evenodd"/><path d="m10.7493 2.72581c0-.40086-.3355-.72581-.74931-.72581-.41385 0-.74933.32495-.74933.72581l-.00001 9.72199-3.97032-3.97029c-.29289-.29289-.76777-.29289-1.06066 0s-.29289.76777 0 1.06066l5.24532 5.24533c.2929.2929.76781.2929 1.06071 0l5.2558-5.25585c.2929-.2929.2929-.76777 0-1.06067-.2929-.29289-.7678-.29289-1.0606 0l-3.9716 3.97152z"/></g></svg>\n'},37746:(e,t,o)=>{o.d(t,{A:()=>r});const n=e=>{try{e.dispatchEvent(new MouseEvent("click"))}catch(t){const o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(o)}},c=async(e,t="download")=>{const o=document.createElement("a");o.download=t,o.rel="noopener",(globalThis?.chrome?.runtime?.id||globalThis?.browser?.runtime?.id)&&(o.target="_blank"),"string"==typeof e?(o.href=e,o.origin!==location.origin?await(async e=>{try{const t=await globalThis.fetch(e,{method:"HEAD"});return t.status>=200&&t.status<=299}catch(e){console.error(e)}return!1})(o.href)?await(async(e,t)=>{try{const o=await globalThis.fetch(e,{method:"GET"}),n=await o.blob();await c(n,t)}catch(e){console.error(e)}})(e,t):(o.target="_blank",n(o)):n(o)):(o.href=URL.createObjectURL(e),setTimeout(()=>{URL.revokeObjectURL(o.href)},4e4),setTimeout(()=>{n(o)},0))},r=c},47812:(e,t,o)=>{o.d(t,{P:()=>c});var n=o(50313);const c=()=>(0,n.A)("ElementTooltip")},53644:(e,t,o)=>{o.d(t,{A:()=>c});let n=0;const c=e=>{const t=!!document.importNode;let o=(new DOMParser).parseFromString(e,"image/svg+xml").documentElement;t&&(o=document.importNode(o,!0));for(const e of o.querySelectorAll("title,desc"))e.remove();for(const e of o.querySelectorAll("[id]")){if(!e.id)continue;const t="vknext_icon-"+n++;let c=!1;for(const n of o.querySelectorAll(`[fill="url(#${e.id})"]`))n.setAttribute("fill",`url(#${t})`),c=!0;c&&(e.id=t)}return o}},57448:(e,t,o)=>{o.d(t,{A:()=>n});const n=e=>{const t=new URL(e).pathname;return t.substring(t.lastIndexOf("/")+1)}},62493:(e,t,o)=>{o.d(t,{A:()=>c,B:()=>n});const n=["a","b","i","p","q","s","w","z","y","x","r","o","m","g","max","l","f","k","c","e","d","j","temp","h","n"],c=(e=window.cur.pvCurPhoto)=>{if(!e)throw new Error("Фоторедактор не открыт");let t=null,o=0;for(const[c,r]of Object.entries(e)){const e=c.slice(0,-1);if(n.includes(e)){const[e,n,c]=r,s=n*c;s>o&&(o=s,t=[e,n,c])}}if(!t)throw new Error("Фото не найдено");return t}}}]);