"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[3917],{23917:(t,e,o)=>{var n=o(74848),a=o(79110),i=o(7417),s=o(93819);const r=new(o(51018).e);let u=!1;const l=()=>{if(u)return;u=!0;const t=window.customElements.define;window.customElements.define=function(e,o,n,...a){for(const t of r.listeners)try{t({name:e,constructor:o,options:n})}catch(t){console.error(t)}return Reflect.apply(t,this,[e,o,n,...a])}},c=t=>{const e=r.addListener(t);return l(),e};var d=o(3068);const p=Symbol(),I="vknext_download_video",w="vknext_video_downloader",m="vk-video-player",y=async t=>{const e=await s.A;return{id:I,testId:I,weight:550,type:"desktop-control-panel-right",icon:"data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjZmZmIiBkPSJNMTIuMDAyIDJhLjkuOSAwIDAgMSAuOS45djExLjAwMmw0LjU2Mi00LjYzMWEuOS45IDAgMSAxIDEuMjgzIDEuMjYzbC02LjEwNCA2LjE5NWEuOS45IDAgMCAxLTEuMjg0LS4wMDFsLTYuMDktNi4yMDZhLjkuOSAwIDEgMSAxLjI4Ni0xLjI2bDQuNTQ3IDQuNjMzVjIuOWEuOS45IDAgMCAxIC45LS45bS04IDE4LjFhLjkuOSAwIDAgMSAuOS0uOWgxNC4yYS45LjkgMCAxIDEgMCAxLjhoLTE0LjJhLjkuOSAwIDAgMS0uOS0uOSIvPjwvc3ZnPg==",ariaLabel:e.use("global_download"),tooltipText:e.use("global_download"),hideOnDesktopGridTypes:[],disableMouseupTooltipShow:!0,onClick:async e=>{const a=e.target;if(!(a instanceof HTMLElement))return;if(t.querySelector(`#${w}`))return;const i=a.closest('button,[data-testid="vknext_download_video"]'),s=document.createElement("div");s.id=w,t.appendChild(s);const{default:r}=await Promise.all([o.e(961),o.e(7397),o.e(1649),o.e(682)]).then(o.bind(o,90682)),{unmount:u}=await(0,d.A)({root:s,content:(0,n.jsx)(r,{player:t,button:i}),disableParentTransformForPositionFixedElements:!0,disablePortal:!0}),l=t.unmountComponent;t.unmountComponent=function(...t){return u(),Reflect.apply(l,this,t)}}}},A=t=>{if(t.prototype[p])return;t.prototype[p]=!0;const e=t.prototype.initPlayer;t.prototype.initPlayer=async function(...t){try{Array.isArray(t[0].additionalButtons)||(t[0].additionalButtons=[]),t[0].additionalButtons.push(await y(this));const e=t[1]?.ui;e?.features&&(e.features.additionalButtons=!0)}catch(t){console.error(t)}return Reflect.apply(e,this,t)}},S=async()=>{for(const t of document.querySelectorAll(m))t.store.actions.external.addAdditionalButton(await y(t))};(()=>{const t=window.customElements.get(m);t&&A(t)})(),S().catch(console.error),(0,a.g)(S),(0,i.n)(S),c(({name:t,constructor:e})=>{t===m&&A(e)})}}]);